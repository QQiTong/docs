<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>原生Python支持 | 专业投机策略</title>
    <meta name="description" content="迎接新的时代">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.CKNdbejm.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.o1hFbhh8.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.C3n1pjgi.js">
    <link rel="modulepreload" href="/assets/chunks/framework.b7dag8kZ.js">
    <link rel="modulepreload" href="/assets/mq5_programming_for_traders_advanced_language_tools_native_python_support.md.CAzzlsno.lean.js">
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <link rel="alternate" type="application/rss+xml" href="/blog.rss">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&amp;family=Manrope:wght@600&amp;family=IBM+Plex+Mono:wght@400&amp;display=swap" as="style">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&amp;family=Manrope:wght@600&amp;family=IBM+Plex+Mono:wght@400&amp;display=swap">
    <link rel="me" href="https://m.webtoo.ls/@vite">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://vite.dev/og-image.jpg">
    <meta property="og:url" content="https://vite.dev">
    <meta property="og:description" content="Next Generation Frontend Tooling">
    <meta property="og:site_name" content="vitejs">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@vite_js">
    <meta name="theme-color" content="#646cff">
    <script src="https://cdn.usefathom.com/script.js" data-site="TPLGJZGR" data-spa="auto" defer></script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <link rel="canonical" href="https://vite.dev/mq5_programming_for_traders/advanced_language_tools/native_python_support">
    <meta property="og:title" content="原生Python支持">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-e8cbffd7><!--[--><!--]--><!--[--><span tabindex="-1" data-v-4e586869></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-4e586869>Skip to content</a><!--]--><!----><header class="VPNav" data-v-e8cbffd7 data-v-7a0b7e8a><div class="VPNavBar" data-v-7a0b7e8a data-v-357046c4><div class="wrapper" data-v-357046c4><div class="container" data-v-357046c4><div class="title" data-v-357046c4><div class="VPNavBarTitle has-sidebar" data-v-357046c4 data-v-c0b09a5e><a class="title" href="/" data-v-c0b09a5e><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.svg" alt data-v-7d39a773><!--]--><span data-v-c0b09a5e>专业投机策略</span><!--[--><!--]--></a></div></div><div class="content" data-v-357046c4><div class="content-body" data-v-357046c4><!--[--><!--]--><div class="VPNavBarSearch search" data-v-357046c4><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-357046c4 data-v-a8ff5a32><span id="main-nav-aria-label" class="visually-hidden" data-v-a8ff5a32> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/strategy_square/" tabindex="0" data-v-a8ff5a32 data-v-25d839e6><!--[--><span data-v-25d839e6>策略广场</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-a8ff5a32 data-v-00041c6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00041c6c><span class="text" data-v-00041c6c><!----><span data-v-00041c6c>外盘策略</span><span class="vpi-chevron-down text-icon" data-v-00041c6c></span></span></button><div class="menu" data-v-00041c6c><div class="VPMenu" data-v-00041c6c data-v-64b59e26><div class="items" data-v-64b59e26><!--[--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_strategy/trend_follow/" data-v-06756f99><!--[--><span data-v-06756f99>趋势跟踪</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_strategy/martingale/" data-v-06756f99><!--[--><span data-v-06756f99>马丁格尔</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_strategy/frequency_trading/" data-v-06756f99><!--[--><span data-v-06756f99>高频交易</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/future_strategy/" tabindex="0" data-v-a8ff5a32 data-v-25d839e6><!--[--><span data-v-25d839e6>期货策略</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-a8ff5a32 data-v-00041c6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00041c6c><span class="text" data-v-00041c6c><!----><span data-v-00041c6c>MT5编辑器</span><span class="vpi-chevron-down text-icon" data-v-00041c6c></span></span></button><div class="menu" data-v-00041c6c><div class="VPMenu" data-v-00041c6c data-v-64b59e26><div class="items" data-v-64b59e26><!--[--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/metaeditor/welcome/" data-v-06756f99><!--[--><span data-v-06756f99>欢迎来到算法交易</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/metaeditor/main_menu/" data-v-06756f99><!--[--><span data-v-06756f99>主菜单</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/metaeditor/toolbar/" data-v-06756f99><!--[--><span data-v-06756f99>工具栏</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/metaeditor/workspace/" data-v-06756f99><!--[--><span data-v-06756f99>工作区</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/metaeditor/mql5storage/" data-v-06756f99><!--[--><span data-v-06756f99>MQL5存储</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/metaeditor/mql5_wizard/" data-v-06756f99><!--[--><span data-v-06756f99>MQL4/MQL5 向导</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/metaeditor/development/" data-v-06756f99><!--[--><span data-v-06756f99>开发程序</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/metaeditor/other/" data-v-06756f99><!--[--><span data-v-06756f99>其它</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-a8ff5a32 data-v-00041c6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00041c6c><span class="text" data-v-00041c6c><!----><span data-v-00041c6c>MQL5快速入门</span><span class="vpi-chevron-down text-icon" data-v-00041c6c></span></span></button><div class="menu" data-v-00041c6c><div class="VPMenu" data-v-00041c6c data-v-64b59e26><div class="items" data-v-64b59e26><!--[--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_quick_start/welcome/" data-v-06756f99><!--[--><span data-v-06756f99>初步认识</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_quick_start/basic_grammar/" data-v-06756f99><!--[--><span data-v-06756f99>基础语法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_quick_start/first_real_ea/" data-v-06756f99><!--[--><span data-v-06756f99>第一个EA</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_quick_start/advance_konwledge/" data-v-06756f99><!--[--><span data-v-06756f99>进阶知识</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_quick_start/classic_strategy/" data-v-06756f99><!--[--><span data-v-06756f99>经典策略</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mt5_quick_start/indicator_tools/" data-v-06756f99><!--[--><span data-v-06756f99>指标工具</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-a8ff5a32 data-v-00041c6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-00041c6c><span class="text" data-v-00041c6c><!----><span data-v-00041c6c>MQL5官方教程</span><span class="vpi-chevron-down text-icon" data-v-00041c6c></span></span></button><div class="menu" data-v-00041c6c><div class="VPMenu" data-v-00041c6c data-v-64b59e26><div class="items" data-v-64b59e26><!--[--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mq5_programming_for_traders/welcome/" data-v-06756f99><!--[--><span data-v-06756f99>开始</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/" data-v-06756f99><!--[--><span data-v-06756f99>MQL5编程基础</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mq5_programming_for_traders/object_oriented_programming/" data-v-06756f99><!--[--><span data-v-06756f99>面向对象</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mq5_programming_for_traders/common_mql5_apis/" data-v-06756f99><!--[--><span data-v-06756f99>常用API</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mq5_programming_for_traders/creating_application_programs/" data-v-06756f99><!--[--><span data-v-06756f99>在 MQL5 中创建应用程序</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mq5_programming_for_traders/trading_automation/" data-v-06756f99><!--[--><span data-v-06756f99>交易自动化</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-64b59e26 data-v-06756f99><a class="VPLink link" href="/mq5_programming_for_traders/advanced_language_tools/" data-v-06756f99><!--[--><span data-v-06756f99>MQL5高级工具</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/article/" tabindex="0" data-v-a8ff5a32 data-v-25d839e6><!--[--><span data-v-25d839e6>经典文章</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about/" tabindex="0" data-v-a8ff5a32 data-v-25d839e6><!--[--><span data-v-25d839e6>关于我</span><!--]--></a><!--]--><!--]--></nav><!----><!----><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-357046c4 data-v-a318d133 data-v-43df44de><!--[--><a class="VPSocialLink no-icon" href="https://www.douyin.com/user/MS4wLjABAAAAVb-2dWdStZkPrNrzAGkHhhquMun5zaNAUsNPN166PCA" aria-label="tiktok" target="_blank" rel="noopener" data-v-43df44de data-v-b3f2150c><span class="vpi-social-tiktok"></span></a><a class="VPSocialLink no-icon" href="https://space.bilibili.com/485926738" aria-label="bilibili" target="_blank" rel="noopener" data-v-43df44de data-v-b3f2150c><span class="vpi-social-bilibili"></span></a><a class="VPSocialLink no-icon" href="https://mp.weixin.qq.com/s/ZygbW2MwCtUQfEvXqYS1vA" aria-label="wechat" target="_blank" rel="noopener" data-v-43df44de data-v-b3f2150c><span class="vpi-social-wechat"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-357046c4 data-v-72eb2fc7 data-v-00041c6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-00041c6c><span class="vpi-more-horizontal icon" data-v-00041c6c></span></button><div class="menu" data-v-00041c6c><div class="VPMenu" data-v-00041c6c data-v-64b59e26><!----><!--[--><!--[--><!----><!----><div class="group" data-v-72eb2fc7><div class="item social-links" data-v-72eb2fc7><div class="VPSocialLinks social-links-list" data-v-72eb2fc7 data-v-43df44de><!--[--><a class="VPSocialLink no-icon" href="https://www.douyin.com/user/MS4wLjABAAAAVb-2dWdStZkPrNrzAGkHhhquMun5zaNAUsNPN166PCA" aria-label="tiktok" target="_blank" rel="noopener" data-v-43df44de data-v-b3f2150c><span class="vpi-social-tiktok"></span></a><a class="VPSocialLink no-icon" href="https://space.bilibili.com/485926738" aria-label="bilibili" target="_blank" rel="noopener" data-v-43df44de data-v-b3f2150c><span class="vpi-social-bilibili"></span></a><a class="VPSocialLink no-icon" href="https://mp.weixin.qq.com/s/ZygbW2MwCtUQfEvXqYS1vA" aria-label="wechat" target="_blank" rel="noopener" data-v-43df44de data-v-b3f2150c><span class="vpi-social-wechat"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-357046c4 data-v-5440f226><span class="container" data-v-5440f226><span class="top" data-v-5440f226></span><span class="middle" data-v-5440f226></span><span class="bottom" data-v-5440f226></span></span></button></div></div></div></div><div class="divider" data-v-357046c4><div class="divider-line" data-v-357046c4></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-e8cbffd7 data-v-315e22c6><div class="container" data-v-315e22c6><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-315e22c6><span class="vpi-align-left menu-icon" data-v-315e22c6></span><span class="menu-text" data-v-315e22c6>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-315e22c6 data-v-41946b35><button data-v-41946b35>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-e8cbffd7 data-v-2381695a><div class="curtain" data-v-2381695a></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-2381695a><span class="visually-hidden" id="sidebar-aria-label" data-v-2381695a> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-54ab8e9b><section class="VPSidebarItem level-0" data-v-54ab8e9b data-v-0221ad41><div class="item" role="button" tabindex="0" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><h2 class="text" data-v-0221ad41>开始</h2><!----></div><div class="items" data-v-0221ad41><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>大纲</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/introduction_to_mql5" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/editing_compiling_running" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>编辑编译运行</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/mql_wizard" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>MQL向导</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/statements" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>语句代码块函数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/first_program" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>第一个程序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/data_types_and_values" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>数据类型和值</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/variables_and_identifiers" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>变量和标识符</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/assignment_and_initialization" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>赋值和初始化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/data_input" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>数据输入</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/error_fixing_and_debugging" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>修复错误和调试</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/data_output" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>数据输出</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/formatting" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>格式化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/welcome/mini_summary" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>迷你小结</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-54ab8e9b><section class="VPSidebarItem level-0 collapsible collapsed" data-v-54ab8e9b data-v-0221ad41><div class="item" role="button" tabindex="0" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><h2 class="text" data-v-0221ad41>MQL5编程基础</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0221ad41><span class="vpi-chevron-right caret-icon" data-v-0221ad41></span></div></div><div class="items" data-v-0221ad41><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/identifiers/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>标识符</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/built-in_data_types/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>内置数据类型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/variables/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>变量</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/arrays/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>数组</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/expresssions/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>表达式</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/type_conversion/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>类型转换</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/statements/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>语句</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/function/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>函数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/mql5_programming_fundamentals/preprocessor/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>预处理</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-54ab8e9b><section class="VPSidebarItem level-0 collapsible collapsed" data-v-54ab8e9b data-v-0221ad41><div class="item" role="button" tabindex="0" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><h2 class="text" data-v-0221ad41>面向对象</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0221ad41><span class="vpi-chevron-right caret-icon" data-v-0221ad41></span></div></div><div class="items" data-v-0221ad41><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/object_oriented_programming/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/object_oriented_programming/structures_and_unions" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>结构体和联合体</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/object_oriented_programming/classes_and_interfaces" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>类和接口</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/object_oriented_programming/templates" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>模板</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-54ab8e9b><section class="VPSidebarItem level-0 collapsible collapsed" data-v-54ab8e9b data-v-0221ad41><div class="item" role="button" tabindex="0" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><h2 class="text" data-v-0221ad41>常用API</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0221ad41><span class="vpi-chevron-right caret-icon" data-v-0221ad41></span></div></div><div class="items" data-v-0221ad41><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/built-in_type_conversions" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>内置类型转换</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/working_with_strings_and_symbols" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>字符串和符号处理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/working_with_arrays" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>数组操作</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/mathematical_functions" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>数学函数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/working_with_files" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>文件操作</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/client_terminal_global_variables" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>客户端全局变量</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/functions_for_working_with_time" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>时间相关函数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/user_interaction" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>用户交互</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/mql_program_execution_environment" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>MQL 程序执行环境</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/common_mql5_apis/matrices_and_vectors" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>矩阵和向量</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-54ab8e9b><section class="VPSidebarItem level-0 collapsible collapsed" data-v-54ab8e9b data-v-0221ad41><div class="item" role="button" tabindex="0" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><h2 class="text" data-v-0221ad41>在 MQL5 中创建应用程序</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0221ad41><span class="vpi-chevron-right caret-icon" data-v-0221ad41></span></div></div><div class="items" data-v-0221ad41><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/general_principles" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>一般原则</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/script_and_services" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>脚本和服务</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/timeseries" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>时间序列</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/creating_custom_indicators" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>自定义指标</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/ready-made-indicators" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>自带指标</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/working_with_timer" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>定时器的使用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/working_with_charts" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>图表操作</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/graphical_objects" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>图表对象</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/creating_application_programs/interactive_events_on_charts" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>图表上的交互式事件</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-54ab8e9b><section class="VPSidebarItem level-0 collapsible collapsed" data-v-54ab8e9b data-v-0221ad41><div class="item" role="button" tabindex="0" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><h2 class="text" data-v-0221ad41>交易自动化</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0221ad41><span class="vpi-chevron-right caret-icon" data-v-0221ad41></span></div></div><div class="items" data-v-0221ad41><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/trading_automation/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/trading_automation/financial_instruments_and_market_watch" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>金融工具与市场报价</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/trading_automation/depth_of_market" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>市场深度</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/trading_automation/trading_account_information" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>交易账户信息</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/trading_automation/createing_expert_advisors" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>创建智能交易顾问</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/trading_automation/testing_and_optimization_of_expert_advisors" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>专家顾问的测试和优化</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-54ab8e9b><section class="VPSidebarItem level-0 collapsible collapsed has-active" data-v-54ab8e9b data-v-0221ad41><div class="item" role="button" tabindex="0" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><h2 class="text" data-v-0221ad41>MQL5高级工具</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0221ad41><span class="vpi-chevron-right caret-icon" data-v-0221ad41></span></div></div><div class="items" data-v-0221ad41><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/resources" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>资源</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/custom_symbol" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>自定义交易品种</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/economic_calendar" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>经济日历</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/cryptography" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>密码学</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/network_functions" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>网络函数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/sqlite_database" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>SQLite 数据库</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/connection_of_binary_format_libraries" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>二进制格式库的开发与连接</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/projects" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>项目</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/native_python_support" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>原生python支持</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/opencl" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>opencl</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0221ad41 data-v-0221ad41><div class="item" data-v-0221ad41><div class="indicator" data-v-0221ad41></div><a class="VPLink link link" href="/mq5_programming_for_traders/advanced_language_tools/conclusion" data-v-0221ad41><!--[--><p class="text" data-v-0221ad41>总结</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-e8cbffd7 data-v-41fb371c><div class="VPDoc has-sidebar has-aside" data-v-41fb371c data-v-c23ecb28><!--[--><!--]--><div class="container" data-v-c23ecb28><div class="aside" data-v-c23ecb28><div class="aside-curtain" data-v-c23ecb28></div><div class="aside-container" data-v-c23ecb28><div class="aside-content" data-v-c23ecb28><div class="VPDocAside" data-v-c23ecb28 data-v-296f4c62><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-296f4c62 data-v-e8bc4af3><div class="content" data-v-e8bc4af3><div class="outline-marker" data-v-e8bc4af3></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-e8bc4af3>本页目录</div><ul class="VPDocOutlineItem root" data-v-e8bc4af3 data-v-4326957b><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-296f4c62></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c23ecb28><div class="content-container" data-v-c23ecb28><!--[--><!--]--><main class="main" data-v-c23ecb28><div style="position:relative;" class="vp-doc _mq5_programming_for_traders_advanced_language_tools_native_python_support" data-v-c23ecb28><div><h1 id="原生python支持" tabindex="-1">原生Python支持 <a class="header-anchor" href="#原生python支持" aria-label="Permalink to &quot;原生Python支持&quot;">​</a></h1><p>自动化交易的潜在成功在很大程度上取决于实现该理念时可用技术的广度。正如我们在前面章节中所看到的，MQL5允许你突破严格的应用交易任务范畴，为与外部服务集成（例如基于网络功能和自定义符号）、使用关系型数据库处理和存储数据以及连接任意库提供了机会。</p><p>最后一点使得与任何以DLL格式提供API的软件进行交互成为可能。一些开发者利用这种方法连接到工业级分布式数据库管理系统（而非内置的SQLite）、像R或MATLAB这样的数学软件包，以及其他编程语言。</p><p>Python已成为最受欢迎的编程语言之一。它的特点是核心精简，并且有各种现成的脚本集合（即软件包）来构建应用解决方案。交易者可从丰富多样的软件包及其强大功能中受益，这些软件包可用于基础市场分析（统计计算、数据可视化）以及交易假设测试，包括机器学习。</p><p>顺应这一趋势，MQ于2019年在MQL5中引入了对Python的支持。这种更紧密的“开箱即用”集成允许将技术分析和交易算法完全迁移到Python环境中。</p><p>从技术角度来看，集成是通过在Python中安装“MetaTrader5”软件包来实现的，该软件包可组织与终端的进程间交互（在撰写本文时，是通过ipykernel/RPC机制实现的）。</p><p>该软件包的功能中，有与内置MQL5函数完全对应的功能，可用于获取有关终端、交易账户、市场报价窗口中的交易品种、报价、行情数据、市场深度、订单、持仓和交易的信息。此外，该软件包还允许切换交易账户、发送交易订单、检查保证金要求以及实时评估潜在的盈亏情况。</p><p>然而，与Python的集成存在一些限制。特别是在Python中无法实现诸如OnTick、OnBookEvent等事件处理。因此，有必要使用无限循环来检查新价格，这与我们在MQL5脚本中不得不做的类似。分析交易订单的执行情况同样困难：由于没有OnTradeTransaction事件，需要编写更多代码才能了解持仓是全部还是部分平仓。为了绕过这些限制，你可以组织Python脚本和MQL5之间的交互，例如通过套接字。mql5.com网站上有介绍实现这种桥梁的示例文章。</p><p>因此，在处理报价、行情数据或交易账户历史的机器学习任务中，将Python与MetaTrader 5结合使用似乎是理所当然的。遗憾的是，在Python中无法获取指标读数。</p><h2 id="安装python和metatrader5包" tabindex="-1">安装Python和MetaTrader5包 <a class="header-anchor" href="#安装python和metatrader5包" aria-label="Permalink to &quot;安装Python和MetaTrader5包&quot;">​</a></h2><p>要学习本章的内容，你的计算机上必须安装Python。如果你还未安装，可从<a href="https://www.python.org/downloads/windows" target="_blank" rel="noreferrer">https://www.python.org/downloads/windows</a> 下载最新版本的Python（例如，在撰写本文时是3.10版本）。</p><p>安装Python时，建议勾选“Add Python to PATH”选项，这样你就能从任意文件夹的命令行运行Python脚本。</p><p>Python下载并安装完成后，可通过命令行安装MetaTrader5模块（这里的pip是标准的Python包管理程序）：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>pip install MetaTrader5</span></span></code></pre></div><p>随后，你可以使用以下命令行检查该包是否有更新：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>pip install --upgrade MetaTrader5</span></span></code></pre></div><p>安装其他常用包的语法与之类似。特别是，很多脚本需要数据分析和可视化包，分别是pandas和matplotlib。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>pip install matplotlib</span></span>
<span class="line"><span>pip install pandas</span></span></code></pre></div><p>你可以直接在MetaEditor的MQL5向导中创建新的Python脚本。除了脚本名称外，用户还能选择导入多个包的选项，比如TensorFlow、NumPy或Datetime。</p><p>默认情况下，建议将脚本放置在MQL5/Scripts文件夹中。新创建和已有的Python脚本会显示在MetaTrader 5导航器中，并带有特殊图标标记，且可以像平常一样从导航器中启动。Python脚本可以和其他MQL5脚本以及智能交易系统在图表上并行执行。如果脚本进入循环执行状态，要停止它，只需将其从图表中移除即可。</p><h3 id="在终端中运行python脚本" tabindex="-1">在终端中运行Python脚本 <a class="header-anchor" href="#在终端中运行python脚本" aria-label="Permalink to &quot;在终端中运行Python脚本&quot;">​</a></h3><p>从终端启动的Python脚本会通过命令行参数接收交易品种名称和图表的时间周期。例如，我们可以在EURUSD的H1图表上运行以下脚本，其中的参数可以通过sys.argv数组获取：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;The command line arguments are:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sys.argv:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i)</span></span></code></pre></div><p>它会在专家日志中输出：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>The command line arguments are:</span></span>
<span class="line"><span>C:\Program Files\MetaTrader 5\MQL5\Scripts\MQL5Book\Python\python-args.py</span></span>
<span class="line"><span>EURUSD</span></span>
<span class="line"><span>60</span></span></code></pre></div><p>此外，你可以在MetaEditor的设置对话框中指定Python的安装位置，然后在“编译器”选项卡中操作，这样就能直接从MetaEditor运行Python脚本。此时，扩展名为*.py的文件的编译命令就变成了运行命令。</p><p>最后，也可以在Python的原生环境中运行Python脚本，方法是从命令行调用python.exe并传入脚本作为参数，或者使用其他适配Python的集成开发环境（IDE），比如Jupyter Notebook。</p><p>如果终端中启用了算法交易，那么默认情况下也会启用从Python进行交易的功能。为了在使用第三方Python库时进一步保护账户，平台设置中提供了“Disable automatic trading via external Python API”（禁用通过外部Python API进行自动交易）选项。这样，Python脚本可以选择性地阻止交易，而让MQL程序仍可进行交易。启用此选项后，Python脚本中的交易函数调用将返回错误代码10027（TRADE_RETCODE_CLIENT_DISABLES_AT），表明客户端终端已禁用算法交易。</p><h3 id="mql5与python对比" tabindex="-1">MQL5与Python对比 <a class="header-anchor" href="#mql5与python对比" aria-label="Permalink to &quot;MQL5与Python对比&quot;">​</a></h3><p>Python是一种解释型语言，这与编译型的MQL5不同。对于开发者而言，这让我们的工作更轻松，因为无需单独的编译阶段就能得到可运行的程序。不过，Python脚本的执行速度明显低于MQL5编译后的程序。</p><p>Python是动态类型语言：变量的类型由赋给它的值决定。一方面，这带来了灵活性，但也要求我们格外谨慎，以避免出现意外错误。而MQL5使用静态类型，也就是说，在描述变量时，必须明确指定其类型，编译器会检查类型兼容性。</p><p>Python会自动进行“垃圾清理”，即释放应用程序为对象分配的内存。在MQL5中，我们需要手动及时调用delete来释放动态对象的内存。</p><p>在Python语法中，源代码的缩进起着重要作用。如果需要编写包含多个嵌套语句块的复合语句（例如循环或条件语句），Python使用空格或制表符来实现（在语句块内，它们的大小必须一致），不允许混用制表符和空格。缩进错误会导致程序出错。在MQL5中，我们通过用花括号{ ... }括起来的方式来形成复合语句块，但格式本身并不影响程序性能，你可以采用任何喜欢的风格进行编写。</p><p>Python函数支持两种类型的参数：命名参数和位置参数。位置参数与我们在MQL5中习惯的参数类型相对应：每个参数的值必须严格按照其在参数列表中的顺序传递（根据函数原型）。相比之下，命名参数以名称和值的组合形式传递（中间用&#39;=&#39;连接），因此可以按任意顺序指定，例如func(param2 = value2, param1 = value1)。</p><h2 id="python中metatrader5包的函数概述" tabindex="-1">Python中MetaTrader5包的函数概述 <a class="header-anchor" href="#python中metatrader5包的函数概述" aria-label="Permalink to &quot;Python中MetaTrader5包的函数概述&quot;">​</a></h2><p>Python中可用的API函数可以有条件地分为两组：在MQL5 API中有完全对应函数的一组，以及仅在Python中可用的一组函数。第二组函数存在的部分原因是，在使用应用函数之前，必须在技术上组织好Python与MetaTrader 5之间的连接。这就解释了<code>initialize</code>和<code>shutdown</code>这一对函数的存在和用途：第一个函数用于建立与终端的连接，第二个函数用于终止该连接。</p><p>重要的是，在初始化过程中，可以启动所需的终端副本（如果尚未执行），并且可以选择特定的交易账户。此外，在已经打开与终端的连接的情况下，也可以更改交易账户：这通过<code>login</code>函数来完成。</p><p>在连接到终端后，Python脚本可以使用<code>version</code>函数获取终端版本的摘要信息。通过<code>terminal_info</code>可以获取关于终端的完整信息，它完全类似于三个<code>TerminalInfo</code>函数，就好像它们被合并为一个调用一样。</p><p>以下表格列出了Python应用函数及其在MQL5 API中的对应函数：</p><table tabindex="0"><thead><tr><th>Python</th><th>MQL5</th></tr></thead><tbody><tr><td><code>last_error</code></td><td><code>GetLastError</code>（注意！Python有其自身的错误代码）</td></tr><tr><td><code>account_info</code></td><td><code>AccountInfoInteger</code>，<code>AccountInfoDouble</code>，<code>AccountInfoString</code></td></tr><tr><td><code>terminal_info</code></td><td><code>TerminalInfoInteger</code>，<code>TerminalInfoDouble</code>，<code>TerminalInfoDouble</code></td></tr><tr><td><code>symbols_total</code></td><td><code>SymbolsTotal</code>（所有符号，包括自定义和已禁用的符号）</td></tr><tr><td><code>symbols_get</code></td><td><code>SymbolsTotal</code> + <code>SymbolInfo</code>函数</td></tr><tr><td><code>symbol_info</code></td><td><code>SymbolInfoInteger</code>，<code>SymbolInfoDouble</code>，<code>SymbolInfoString</code></td></tr><tr><td><code>symbol_info_tick</code></td><td><code>SymbolInfoTick</code></td></tr><tr><td><code>symbol_select</code></td><td><code>SymbolSelect</code></td></tr><tr><td><code>market_book_add</code></td><td><code>MarketBookAdd</code></td></tr><tr><td><code>market_book_get</code></td><td><code>MarketBookGet</code></td></tr><tr><td><code>market_book_release</code></td><td><code>MarketBookRelease</code></td></tr><tr><td><code>copy_rates_from</code></td><td><code>CopyRates</code>（按柱数，从日期/时间开始）</td></tr><tr><td><code>copy_rates_from_pos</code></td><td><code>CopyRates</code>（按柱数，从柱编号开始）</td></tr><tr><td><code>copy_rates_range</code></td><td><code>CopyRates</code>（在日期/时间范围内）</td></tr><tr><td><code>copy_ticks_from</code></td><td><code>CopyTicks</code>（按Ticks数，从指定时间开始）</td></tr><tr><td><code>copy_ticks_range</code></td><td><code>CopyTicksRange</code>（在指定时间范围内）</td></tr><tr><td><code>orders_total</code></td><td><code>OrdersTotal</code></td></tr><tr><td><code>orders_get</code></td><td><code>OrdersTotal</code> + <code>OrderGet</code>函数</td></tr><tr><td><code>order_calc_margin</code></td><td><code>OrderCalcMargin</code></td></tr><tr><td><code>order_calc_profit</code></td><td><code>OrderCalcProfit</code></td></tr><tr><td><code>order_check</code></td><td><code>OrderCheck</code></td></tr><tr><td><code>order_send</code></td><td><code>OrderSend</code></td></tr><tr><td><code>positions_total</code></td><td><code>PositionsTotal</code></td></tr><tr><td><code>positions_get</code></td><td><code>PositionsTotal</code> + <code>PositionGet</code>函数</td></tr><tr><td><code>history_orders_total</code></td><td><code>HistoryOrdersTotal</code></td></tr><tr><td><code>history_orders_get</code></td><td><code>HistoryOrdersTotal</code> + <code>HistoryOrderGet</code>函数</td></tr><tr><td><code>history_deals_total</code></td><td><code>HistoryDealsTotal</code></td></tr><tr><td><code>history_deals_get</code></td><td><code>HistoryDealsTotal</code> + <code>HistoryDealGet</code>函数</td></tr></tbody></table><p>Python API中的函数有几个特点：</p><p>如前所述，函数可以有命名参数：在调用函数时，这些参数连同名称和值一起指定，在每一对名称和值中，它们用等号<code>=</code>组合在一起。指定命名参数的顺序并不重要（这与MQL5中使用的位置参数不同，位置参数必须遵循函数原型指定的严格顺序）。</p><p>Python函数对Python原生的数据类型进行操作。这不仅包括常见的数字和字符串，还包括几种复合类型，有点类似于MQL5的数组和结构体。</p><p>例如，许多函数返回特殊的Python数据结构：元组（<code>tuple</code>）和具名元组（<code>namedtuple</code>）。</p><p>元组是任意类型元素的序列。可以将其视为一个数组，但与数组不同的是，元组的元素可以是不同的类型。也可以将元组看作是一组结构体字段。</p><p>具名元组与结构体的相似性更近，其中每个元素都有一个标识符。在普通元组中，只能使用索引（方括号，就像在MQL5中一样，即<code>[i]</code>）来访问元素。然而，对于具名元组，我们可以应用解引用操作符（点<code>.</code>）来获取它的“属性”，就像在MQL5结构体中一样（<code>tuple.field</code>）。</p><p>此外，元组和具名元组在代码中不能被编辑（也就是说，它们是常量）。</p><p>另一种流行的类型是字典（<code>dictionary</code>）：一种关联数组，存储键值对，并且键和值的类型都可以变化。使用操作符<code>[]</code>来访问字典的值，键（无论其类型是什么，例如字符串）在方括号之间指定，这使得字典类似于数组。字典不能有两个具有相同键的键值对，也就是说，键总是唯一的。特别是，具名元组可以使用<code>namedtuple._asdict()</code>方法轻松转换为字典。</p><h2 id="将python脚本连接到终端和账户" tabindex="-1">将Python脚本连接到终端和账户 <a class="header-anchor" href="#将python脚本连接到终端和账户" aria-label="Permalink to &quot;将Python脚本连接到终端和账户&quot;">​</a></h2><p>initialize函数用于建立与MetaTrader 5终端的连接，它有两种形式：简短形式（无参数）和完整形式（带有几个可选参数，第一个参数是路径，为位置参数，其余参数均为命名参数）。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> initialize()</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> initialize(path, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">account</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ACCOUNT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">password</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PASSWORD&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SERVER&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">timeout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">portable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>path参数用于设置终端文件（metatrader64.exe）的路径（请注意，与其他参数不同，这是一个未命名参数，所以如果指定了该参数，它必须在参数列表中排在首位）。</p><p>如果未指定路径，模块将尝试自行查找可执行文件（开发者未透露确切的查找算法）。为了避免歧义，请使用带参数的第二种函数形式。</p><p>在account参数中，可以指定交易账户的号码。如果未指定，将使用所选终端实例中最后一个交易账户。</p><p>交易账户的密码在password参数中指定，也可以省略：在这种情况下，将自动使用终端数据库中为指定交易账户存储的密码。</p><p>server参数的处理方式与交易服务器名称类似（按照在终端中指定的名称）：如果未指定，将自动使用终端数据库中为指定交易账户保存的服务器名称。</p><p>timeout参数表示连接的超时时间（以毫秒为单位）（如果超过该时间，将发生错误）。默认值为60000（60秒）。</p><p>portable参数包含一个标志，用于指示是否以便携模式启动终端（默认值为False）。</p><p>如果成功连接到MetaTrader 5终端，该函数返回True，否则返回False。</p><p>如有必要，在调用initialize函数时，可以启动MetaTrader 5终端。</p><p>例如，连接到特定交易账户的操作如下所示。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">login</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 562175752</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;MetaQuotes-Demo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">password</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error()) </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></div><p>login函数也会使用指定的参数连接到交易账户。但这意味着已经建立了与终端的连接，也就是说，该函数通常用于切换账户。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> login(account, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">password</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PASSWORD&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SERVER&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">timeout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>交易账户号码在account参数中提供。这是一个必需的未命名参数，即它必须在参数列表中排在首位。</p><p>password、server和timeout参数与initialize函数中的相关参数相同。</p><p>如果成功连接到交易账户，该函数返回True，否则返回False。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shutdown()</span></span></code></pre></div><p>shutdown函数关闭之前建立的与MetaTrader 5终端的连接。</p><p>上述函数的示例将在下一节中给出。</p><p>建立连接后，脚本可以查询终端的版本信息。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> version()</span></span></code></pre></div><p>version函数以包含三个值的元组形式返回有关MetaTrader 5终端版本的简要信息：版本号、构建版本号和构建日期。</p><table tabindex="0"><thead><tr><th>字段类型</th><th>描述</th></tr></thead><tbody><tr><td>integer</td><td>MetaTrader 5终端版本（当前为500）</td></tr><tr><td>integer</td><td>构建版本号（例如3456）</td></tr><tr><td>string</td><td>构建日期（例如&#39;25 Feb 2022&#39;）</td></tr></tbody></table><p>如果发生错误，该函数返回None，并且可以使用last_error获取错误代码。</p><p>可以使用terminal_info函数获取有关终端的更完整信息。</p><h2 id="错误检查-last-error函数" tabindex="-1">错误检查：last_error函数 <a class="header-anchor" href="#错误检查-last-error函数" aria-label="Permalink to &quot;错误检查：last_error函数&quot;">​</a></h2><p><code>last_error</code>函数返回有关上一个Python错误的信息。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> last_error()</span></span></code></pre></div><p>整数错误代码与为MQL5错误分配并由标准<code>GetLastError</code>函数返回的代码不同。在下表中，缩写“IPC”指的是“进程间通信（Inter-Process Communication）”这一术语。</p><table tabindex="0"><thead><tr><th>常量</th><th>含义</th><th>描述</th></tr></thead><tbody><tr><td>RES_S_OK</td><td>1</td><td>成功</td></tr><tr><td>RES_E_FAIL</td><td>-1</td><td>一般性错误</td></tr><tr><td>RES_E_INVALID_PARAMS</td><td>-2</td><td>无效参数</td></tr><tr><td>RES_E_NO_MEMORY</td><td>-3</td><td>内存分配错误</td></tr><tr><td>RES_E_NOT_FOUND</td><td>-4</td><td>未找到请求的历史记录</td></tr><tr><td>RES_E_INVALID_VERSION</td><td>-5</td><td>不支持的版本</td></tr><tr><td>RES_E_AUTH_FAILED</td><td>-6</td><td>授权错误</td></tr><tr><td>RES_E_UNSUPPORTED</td><td>-7</td><td>不支持的方法</td></tr><tr><td>RES_E_AUTO_TRADING_DISABLED</td><td>-8</td><td>算法交易已禁用</td></tr><tr><td>RES_E_INTERNAL_FAIL</td><td>-10000</td><td>一般性内部进程间通信错误</td></tr><tr><td>RES_E_INTERNAL_FAIL_SEND</td><td>-10001</td><td>发送进程间通信数据时的内部错误</td></tr><tr><td>RES_E_INTERNAL_FAIL_RECEIVE</td><td>-10002</td><td>接收进程间通信数据时的内部错误</td></tr><tr><td>RES_E_INTERNAL_FAIL_INIT</td><td>-10003</td><td>进程间通信内部初始化错误</td></tr><tr><td>RES_E_INTERNAL_FAIL_CONNECT</td><td>-10003</td><td>无进程间通信连接</td></tr><tr><td>RES_E_INTERNAL_FAIL_TIMEOUT</td><td>-10005</td><td>进程间通信超时</td></tr></tbody></table><p>在下面的脚本（<code>MQL5/Scripts/MQL5Book/Python/init.py</code>）中，当连接到终端出现错误时，我们会显示错误代码并退出。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示MetaTrader5软件包的版本</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MetaTrader5 package version: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">__version__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#  5.0.37</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 尝试建立连接或启动MetaTrader 5终端</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error()) </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 脚本的工作部分将在此处</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 终止与终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><h2 id="获取交易账户信息" tabindex="-1">获取交易账户信息 <a class="header-anchor" href="#获取交易账户信息" aria-label="Permalink to &quot;获取交易账户信息&quot;">​</a></h2><p><code>account_info</code> 函数可获取当前交易账户的完整信息。</p><div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>namedtuple account_info()</span></span></code></pre></div><p>该函数以命名元组（<code>namedtuple</code>）结构的形式返回信息。若出现错误，结果将为 <code>None</code>。</p><p>使用此函数，你只需调用一次，就能获取 MQL5 中 <code>AccountInfoInteger</code>、<code>AccountInfoDouble</code> 和 <code>AccountInfoString</code> 函数所提供的所有信息，涵盖所有支持的属性。元组中的字段名与枚举元素名对应，但去掉了 “ACCOUNT_” 前缀，并转换为小写形式。</p><p>本书附带了以下脚本 <code>MQL5/Scripts/MQL5Book/Python/accountinfo.py</code>：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与 MetaTrader 5 终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() 失败，错误代码 =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">account_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.account_info()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> account_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 直接显示交易账户数据</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(account_info)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 以字典形式显示交易账户数据</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;显示 account_info()._asdict():&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    account_info_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> account_info._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> account_info_dict:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prop</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">account_info_dict[prop]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与 MetaTrader 5 终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><p>运行结果大致如下：</p><div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>AccountInfo(login=25115284, trade_mode=0, leverage=100, limit_orders=200, margin_so_mode=0, ... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>显示 account_info()._asdict(): </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  login=25115284 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_mode=0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  leverage=100 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  limit_orders=200 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_so_mode=0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_allowed=True </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_expert=True </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_mode=2 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  currency_digits=2 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  fifo_close=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  balance=99511.4 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  credit=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  profit=41.82 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  equity=99553.22 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin=98.18 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_free=99455.04 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_level=101398.67590140559 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_so_call=50.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_so_so=30.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_initial=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_maintenance=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  assets=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  liabilities=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  commission_blocked=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  name=MetaQuotes Dev Demo </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  server=MetaQuotes - Demo </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  currency=USD </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  company=MetaQuotes Software Corp.</span></span></code></pre></div><p>这段内容主要介绍了如何使用 <code>MetaTrader5</code> 库中的 <code>account_info</code> 函数获取交易账户的详细信息，并通过一个 Python 脚本展示了具体的使用方法和输出示例。</p><h2 id="获取终端信息" tabindex="-1">获取终端信息 <a class="header-anchor" href="#获取终端信息" aria-label="Permalink to &quot;获取终端信息&quot;">​</a></h2><p><code>terminal_info</code>函数允许获取已连接的MetaTrader 5终端的状态和参数。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">namedtuple terminal_info()</span></span></code></pre></div><p>如果成功，该函数会将信息作为具名元组（<code>namedtuple</code>）结构返回；如果出现错误，则返回<code>None</code>。</p><p>在调用此函数一次的情况下，你可以获取MQL5中<code>TerminalInfoInteger</code>、<code>TerminalInfoDouble</code>和<code>TerminalInfoDouble</code>所提供的所有信息，包括所有支持属性的变体。元组中字段的名称与枚举元素的名称相对应，但去掉了“TERMINAL_”前缀，并转换为小写形式。</p><p>例如（请参阅MQL5/Scripts/MQL5Book/Python/terminalinfo.py）：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示MetaTrader 5版本的简要信息</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mt5.version()) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示终端设置和状态的完整信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">terminal_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.terminal_info()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> terminal_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 按原样显示终端数据</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(terminal_info) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 将数据显示为字典</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Show terminal_info()._asdict():&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   terminal_info_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.terminal_info()._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> terminal_info_dict: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(prop, terminal_info_dict[prop]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><p>输出结果可能如下所示：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>[500, 3428, &#39;14 Sep 2022&#39;] </span></span>
<span class="line"><span></span></span>
<span class="line"><span>TerminalInfo(community_account=True, community_connection=True, connected=True,.... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Show terminal_info()._asdict(): </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  community_account=True </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  community_connection=True </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  connected=True </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  dlls_allowed=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_allowed=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  tradeapi_disabled=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  email_enabled=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ftp_enabled=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  notifications_enabled=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  mqid=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  build=2366 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  maxbars=5000 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  codepage=1251 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ping_last=77850 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  community_balance=707.10668201585 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  retransmission=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  company=MetaQuotes Software Corp. </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  name=MetaTrader 5 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  language=Russian </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  path=E:\ProgramFiles\MetaTrader 5 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  data_path=E:\ProgramFiles\MetaTrader 5 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  commondata_path=C:\Users\User\AppData\Roaming\MetaQuotes\Terminal\Common</span></span></code></pre></div><h2 id="获取金融工具信息" tabindex="-1">获取金融工具信息 <a class="header-anchor" href="#获取金融工具信息" aria-label="Permalink to &quot;获取金融工具信息&quot;">​</a></h2><p>MetaTrader5包中的一组函数可用于获取有关金融工具的信息。</p><p>symbol_info函数以具名元组结构的形式返回关于一种金融工具的信息。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">namedtuple symbol_info(symbol)</span></span></code></pre></div><p>所需金融工具的名称在symbol参数中指定。</p><p>一次调用该函数就能提供所有可通过MQL5中的SymbolInfoInteger、SymbolInfoDouble和SymbolInfoString这三个函数及其所有属性获取的信息。具名元组中的字段名称与上述指定函数中使用的枚举元素名称相同，但去掉了“SYMBOL_”前缀，并且为小写形式。</p><p>如果发生错误，该函数返回None。</p><p>注意！为确保函数成功执行，必须在“市场报价”中选择所请求的交易品种。这可以在Python中通过调用symbol_select函数来实现（详见后文）。</p><p>示例（MQL5/Scripts/MQL5Book/Python/eurjpy.py）：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 确保EURJPY在“市场报价”中，否则终止算法</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">selected </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_select(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EURJPY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selected:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Failed to select EURJPY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示EURJPY交易品种的属性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">symbol_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EURJPY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 按原样显示数据（作为元组）</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(symbol_info)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 输出几个特定属性</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EURJPY: spread =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, symbol_info.spread, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;, digits =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, symbol_info.digits)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 将交易品种属性作为字典输出</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Show symbol_info(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EURJPY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)._asdict():&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   symbol_info_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EURJPY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_info_dict:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(prop, symbol_info_dict[prop]))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><p>结果：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>SymbolInfo(custom=False, chart_mode=0, select=True, visible=True, session_deals=0, session_buy_orders=0, session_sell_orders=0, ... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>EURJPY: spread = 17, digits = 3 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Show symbol_info()._asdict(): </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  custom=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  chart_mode=0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  select=True </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  visible=True </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  time=1585069682 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  digits=3 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  spread=17 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  spread_float=True </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ticks_bookdepth=10 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_calc_mode=0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_mode=4 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_exemode=1 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  swap_mode=1 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  swap_rollover3days=3 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_hedged_use_leg=False </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  expiration_mode=7 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  filling_mode=1 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  order_mode=127 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  order_gtc_mode=0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  bid=120.024 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ask=120.041 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  last=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  point=0.001 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_tick_value=0.8977708350166538 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_tick_value_profit=0.8977708350166538 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_tick_value_loss=0.8978272580355541 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_tick_size=0.001 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  trade_contract_size=100000.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  volume_min=0.01 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  volume_max=500.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  volume_step=0.01 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  volume_limit=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  swap_long=-0.2 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  swap_short=-1.2 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_initial=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_maintenance=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  margin_hedged=100000.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  currency_base=EUR </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  currency_profit=JPY </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  currency_margin=EUR </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ...</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_select(symbol, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">enable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>symbol_select函数用于将指定的交易品种添加到“市场报价”中或从其中移除。第一个参数指定交易品种。第二个参数传入True或False，分别表示显示或隐藏该交易品种。</p><p>如果省略第二个可选的未命名参数，根据Python的类型转换规则，bool(none)等同于False。</p><p>该函数是SymbolSelect函数的Python版本。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbols_total()</span></span></code></pre></div><p>symbols_total函数返回MetaTrader 5终端中所有工具的数量，包括自定义交易品种以及当前未在“市场报价”窗口中显示的交易品种。这是函数SymbolsTotal(false)的Python版本。</p><p>接下来，symbols_get函数返回一个元组数组，其中包含有关所有工具或收藏工具的信息，这些工具的名称与可选命名参数group中指定的过滤器匹配。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tuple[] symbols_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">group</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;PATTERN&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>数组元组中的每个元素都是一个具名元组，包含了交易品种的全套属性（我们在上面描述symbol_info函数时看到过类似的元组）。</p><p>由于只有一个参数，调用函数时可以省略其名称。</p><p>如果发生错误，该函数将返回特殊值None。</p><p>group参数允许按名称选择交易品种，还可以在搜索字符串的开头和/或结尾处使用通配符“<em>”（可选）。“</em>”表示0个或任意数量的字符。因此，你可以搜索名称中出现的子字符串，该子字符串前后可以有任意数量的其他字符。例如，“EUR*”表示以“EUR”开头且具有任意名称扩展名的交易品种（或者就是“EUR”本身）。“<em>EUR</em>”过滤器将返回名称中任何位置包含“EUR”子字符串的交易品种。</p><p>此外，group参数可以包含多个由逗号分隔的条件。每个条件都可以使用“<em>”指定为掩码。要排除某些交易品种，可以使用逻辑非运算符“!”。在这种情况下，所有条件将按顺序应用，即首先需要指定包含条件，然后是排除条件。例如，group=&quot;</em>, !<em>EUR</em>&quot;表示我们首先需要选择所有交易品种，然后排除名称中（任意位置）包含“EUR”的交易品种。</p><p>例如，要显示除4种主要外汇货币对之外的交叉货币汇率信息，可以运行以下查询：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">crosses </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbols_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">group</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;*,!*USD*,!*EUR*,!*JPY*,!*GBP*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;len(*,!*USD*,!*EUR*,!*JPY*,!*GBP*):&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(crosses)) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 结果数组的大小 - 交叉货币对的数量</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> crosses: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s.name, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, s)</span></span></code></pre></div><p>结果示例：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>len(*,!*USD*,!*EUR*,!*JPY*,!*GBP*):  10 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>AUDCAD : SymbolInfo(custom=False, chart_mode=0, select=True, visible=True, session_deals=0, session_buy_orders=0, session... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>AUDCHF : SymbolInfo(custom=False, chart_mode=0, select=True, visible=True, session_deals=0, session_buy_orders=0, session... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>AUDNZD : SymbolInfo(custom=False, chart_mode=0, select=True, visible=True, session_deals=0, session_buy_orders=0, session... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>CADCHF : SymbolInfo(custom=False, chart_mode=0, select=False, visible=False, session_deals=0, session_buy_orders=0, sessi... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>NZDCAD : SymbolInfo(custom=False, chart_mode=0, select=False, visible=False, session_deals=0, session_buy_orders=0, sessi... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>NZDCHF : SymbolInfo(custom=False, chart_mode=0, select=False, visible=False, session_deals=0, session_buy_orders=0, sessi... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>NZDSGD : SymbolInfo(custom=False, chart_mode=0, select=False, visible=False, session_deals=0, session_buy_orders=0, sessi... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>CADMXN : SymbolInfo(custom=False, chart_mode=0, select=False, visible=False, session_deals=0, session_buy_orders=0, sessi... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>CHFMXN : SymbolInfo(custom=False, chart_mode=0, select=False, visible=False, session_deals=0, session_buy_orders=0, sessi... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>NZDMXN : SymbolInfo(custom=False, chart_mode=0, select=False, visible=False, session_deals=0, session_buy_orders=0, sessi...</span></span></code></pre></div><p>symbol_info_tick函数可用于获取指定金融工具的最新报价。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_info_tick(symbol)</span></span></code></pre></div><p>唯一的必需参数指定金融工具的名称。</p><p>返回的信息是一个元组，其字段与MqlTick结构中的字段相同。该函数是SymbolInfoTick函数的Python版本。</p><p>如果发生错误，返回None。</p><p>为使该函数正常工作，必须在“市场报价”中启用相应的交易品种。我们在脚本MQL5/Scripts/MQL5Book/Python/gbpusdtick.py中演示这一点。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 尝试将GBPUSD交易品种添加到“市场报价”中</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">selected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.symbol_select(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GBPUSD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selected:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Failed to select GBPUSD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将GBPUSD交易品种的最新报价显示为元组</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lasttick </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info_tick(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GBPUSD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lasttick)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 以字典形式显示报价字段的值</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Show symbol_info_tick(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">GBPUSD</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)._asdict():&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">symbol_info_tick_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lasttick._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_info_tick_dict:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(prop, symbol_info_tick_dict[prop]))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><p>结果应如下所示：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>Tick(time=1585070338, bid=1.17264, ask=1.17279, last=0.0, volume=0, time_msc=1585070338728, flags=2, volume_real=0.0) </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Show symbol_info_tick._asdict(): </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  time=1585070338 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  bid=1.17264 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ask=1.17279 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  last=0.0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  volume=0 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  time_msc=1585070338728 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  flags=2 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>  volume_real=0.0</span></span></code></pre></div><h2 id="订阅订单簿变化" tabindex="-1">订阅订单簿变化 <a class="header-anchor" href="#订阅订单簿变化" aria-label="Permalink to &quot;订阅订单簿变化&quot;">​</a></h2><p>Python API 包含三个用于处理订单簿的函数。</p><h4 id="_1-market-book-add-symbol" tabindex="-1">1. <code>market_book_add(symbol)</code> <a class="header-anchor" href="#_1-market-book-add-symbol" aria-label="Permalink to &quot;1. `market_book_add(symbol)`&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> market_book_add(symbol)</span></span></code></pre></div><p><code>market_book_add</code> 函数用于订阅指定交易品种的订单簿变化事件。所需金融工具的名称通过单个未命名参数指定。</p><p>该函数返回一个布尔值，表示操作是否成功。</p><p>此函数是 MQL5 中 <code>MarketBookAdd</code> 函数的等效实现。在完成订单簿相关工作后，应调用 <code>market_book_release</code> 函数取消订阅（详见后文）。</p><h4 id="_2-market-book-get-symbol" tabindex="-1">2. <code>market_book_get(symbol)</code> <a class="header-anchor" href="#_2-market-book-get-symbol" aria-label="Permalink to &quot;2. `market_book_get(symbol)`&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tuple[] market_book_get(symbol)</span></span></code></pre></div><p><code>market_book_get</code> 函数用于请求指定交易品种的当前订单簿内容。结果以 <code>BookInfo</code> 记录的元组（数组）形式返回。每个记录是 MQL5 中 <code>MqlBookInfo</code> 结构体的等效形式，从 Python 角度看，它是一个命名元组，包含 <code>type</code>、<code>price</code>、<code>volume</code>、<code>volume_dbl</code> 字段。注意，在 Python 中该字段名为 <code>volume_dbl</code>，而在 MQL5 中对应的字段名为 <code>volume_real</code>。若出现错误，则返回 <code>None</code>。</p><p>要使用此函数，必须先使用 <code>market_book_add</code> 函数订阅订单簿事件。</p><p>此函数是 MQL5 中 <code>MarketBookGet</code> 函数的等效实现。需注意，Python 脚本无法直接接收 <code>OnBookEvent</code> 事件，需要在循环中轮询订单簿内容。</p><h4 id="_3-market-book-release-symbol" tabindex="-1">3. <code>market_book_release(symbol)</code> <a class="header-anchor" href="#_3-market-book-release-symbol" aria-label="Permalink to &quot;3. `market_book_release(symbol)`&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> market_book_release(symbol)</span></span></code></pre></div><p><code>market_book_release</code> 函数用于取消对指定交易品种订单簿变化事件的订阅。操作成功时，函数返回 <code>True</code>。此函数是 MQL5 中 <code>MarketBookRelease</code> 函数的等效实现。</p><p>下面是一个简单的示例（见 <code>MQL5/Scripts/MQL5Book/Python/eurusdbook.py</code>）：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导入用于暂停的包</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与 MetaTrader 5 终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 订阅 EURUSD 交易品种的订单簿更新</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.market_book_add(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EURUSD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 循环 10 次以读取订单簿数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 获取订单簿内容</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        items </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.market_book_get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EURUSD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 直接将整个订单簿内容打印在一行中</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(items)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 为清晰起见，将每个价格水平以字典形式单独打印</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> it </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> items </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">or</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(it._asdict())</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 在下一次请求订单簿数据前暂停 5 秒</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        time.sleep(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 取消对订单簿变化的订阅</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mt5.market_book_release(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EURUSD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mt5.market_book_add(&#39;EURUSD&#39;) failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 结束与 MetaTrader 5 终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><h3 id="结果示例" tabindex="-1">结果示例 <a class="header-anchor" href="#结果示例" aria-label="Permalink to &quot;结果示例&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>(BookInfo(type=1, price=1.20036, volume=250, volume_dbl=250.0), BookInfo(type=1, price=1.20029, volume=100, volume...</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20036, &#39;volume&#39;: 250, &#39;volume_dbl&#39;: 250.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20029, &#39;volume&#39;: 100, &#39;volume_dbl&#39;: 100.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20028, &#39;volume&#39;: 50, &#39;volume_dbl&#39;: 50.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20026, &#39;volume&#39;: 36, &#39;volume_dbl&#39;: 36.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20023, &#39;volume&#39;: 36, &#39;volume_dbl&#39;: 36.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20022, &#39;volume&#39;: 50, &#39;volume_dbl&#39;: 50.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20021, &#39;volume&#39;: 100, &#39;volume_dbl&#39;: 100.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20014, &#39;volume&#39;: 250, &#39;volume_dbl&#39;: 250.0}</span></span>
<span class="line"><span>(BookInfo(type=1, price=1.20035, volume=250, volume_dbl=250.0), BookInfo(type=1, price=1.20029, volume=100, volume...</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20035, &#39;volume&#39;: 250, &#39;volume_dbl&#39;: 250.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20029, &#39;volume&#39;: 100, &#39;volume_dbl&#39;: 100.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20027, &#39;volume&#39;: 50, &#39;volume_dbl&#39;: 50.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20025, &#39;volume&#39;: 36, &#39;volume_dbl&#39;: 36.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20023, &#39;volume&#39;: 36, &#39;volume_dbl&#39;: 36.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20022, &#39;volume&#39;: 50, &#39;volume_dbl&#39;: 50.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20021, &#39;volume&#39;: 100, &#39;volume_dbl&#39;: 100.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20014, &#39;volume&#39;: 250, &#39;volume_dbl&#39;: 250.0}</span></span>
<span class="line"><span>(BookInfo(type=1, price=1.20037, volume=250, volume_dbl=250.0), BookInfo(type=1, price=1.20031, volume=100, volume...</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20037, &#39;volume&#39;: 250, &#39;volume_dbl&#39;: 250.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20031, &#39;volume&#39;: 100, &#39;volume_dbl&#39;: 100.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.2003, &#39;volume&#39;: 50, &#39;volume_dbl&#39;: 50.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 1, &#39;price&#39;: 1.20028, &#39;volume&#39;: 36, &#39;volume_dbl&#39;: 36.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20025, &#39;volume&#39;: 36, &#39;volume_dbl&#39;: 36.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20023, &#39;volume&#39;: 50, &#39;volume_dbl&#39;: 50.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20022, &#39;volume&#39;: 100, &#39;volume_dbl&#39;: 100.0}</span></span>
<span class="line"><span>{&#39;type&#39;: 2, &#39;price&#39;: 1.20016, &#39;volume&#39;: 250, &#39;volume_dbl&#39;: 250.0}</span></span>
<span class="line"><span>...</span></span></code></pre></div><p>此示例代码首先建立与 MetaTrader 5 终端的连接，然后订阅 <code>EURUSD</code> 交易品种的订单簿更新。接着在一个循环中，每隔 5 秒获取一次订单簿内容并打印，既打印整个订单簿元组，也将每个价格水平以字典形式单独打印。最后取消订阅并关闭与终端的连接。</p><h2 id="读取报价数据" tabindex="-1">读取报价数据 <a class="header-anchor" href="#读取报价数据" aria-label="Permalink to &quot;读取报价数据&quot;">​</a></h2><p>Python API提供了三个函数，可用于获取价格（K线）数组，这些函数根据指定请求数据范围的方式不同而有所区别：按K线数量或按时间范围。所有函数都类似于MQL5中不同形式的<code>CopyRates</code>函数。</p><p>对于所有这些函数，前两个参数用于指定交易品种名称和时间周期。时间周期在<code>TIMEFRAME</code>枚举中列出，它与MQL5中的<code>ENUM_TIMEFRAMES</code>枚举类似。</p><p>请注意：在Python中，此枚举的元素前缀为<code>TIMEFRAME_</code>，而MQL5中类似枚举的元素前缀为<code>PERIOD_</code>。</p><table tabindex="0"><thead><tr><th>标识符</th><th>描述</th></tr></thead><tbody><tr><td><code>TIMEFRAME_M1</code></td><td>1分钟</td></tr><tr><td><code>TIMEFRAME_M2</code></td><td>2分钟</td></tr><tr><td><code>TIMEFRAME_M3</code></td><td>3分钟</td></tr><tr><td><code>TIMEFRAME_M4</code></td><td>4分钟</td></tr><tr><td><code>TIMEFRAME_M5</code></td><td>5分钟</td></tr><tr><td><code>TIMEFRAME_M6</code></td><td>6分钟</td></tr><tr><td><code>TIMEFRAME_M10</code></td><td>10分钟</td></tr><tr><td><code>TIMEFRAME_M12</code></td><td>12分钟</td></tr><tr><td><code>TIMEFRAME_M15</code></td><td>15分钟</td></tr><tr><td><code>TIMEFRAME_M20</code></td><td>20分钟</td></tr><tr><td><code>TIMEFRAME_M30</code></td><td>30分钟</td></tr><tr><td><code>TIMEFRAME_H1</code></td><td>1小时</td></tr><tr><td><code>TIMEFRAME_H2</code></td><td>2小时</td></tr><tr><td><code>TIMEFRAME_H3</code></td><td>3小时</td></tr><tr><td><code>TIMEFRAME_H4</code></td><td>4小时</td></tr><tr><td><code>TIMEFRAME_H6</code></td><td>6小时</td></tr><tr><td><code>TIMEFRAME_H8</code></td><td>8小时</td></tr><tr><td><code>TIMEFRAME_H12</code></td><td>12小时</td></tr><tr><td><code>TIMEFRAME_D1</code></td><td>1天</td></tr><tr><td><code>TIMEFRAME_W1</code></td><td>1周</td></tr><tr><td><code>TIMEFRAME_MN1</code></td><td>1个月</td></tr></tbody></table><p>这三个函数都以带有命名列的NumPy批量数组形式返回K线数据，这些列包括<code>time</code>（时间）、<code>open</code>（开盘价）、<code>high</code>（最高价）、<code>low</code>（最低价）、<code>close</code>（收盘价）、<code>tick_volume</code>（成交笔数）、<code>spread</code>（点差）和<code>real_volume</code>（真实成交量）。<code>numpy.ndarray</code>数组是命名元组的更高效替代方案。要访问列数据，可使用方括号表示法，即<code>array[&#39;column&#39;]</code>。</p><p>如果发生错误，函数将返回<code>None</code>。</p><p>所有函数的参数都是必填且未命名的。</p><ul><li><code>numpy.ndarray copy_rates_from(symbol, timeframe, date_from, count)</code>：<code>copy_rates_from</code>函数用于请求从指定日期（<code>date_from</code>）开始的<code>count</code>根K线数据。日期可以通过<code>datetime</code>对象设置，也可以设置为自1970年1月1日以来的秒数。</li></ul><p>在创建<code>datetime</code>对象时，Python使用本地时区，而MetaTrader 5终端将报价和K线开盘时间存储为协调世界时（UTC，格林威治标准时间，无偏移）。因此，为了正确执行使用时间的函数，必须创建UTC时区的<code>datetime</code>变量。要配置时区，可以使用<code>pytz</code>包。例如（见<code>MQL5/Scripts/MQL5Book/Python/eurusdrates.py</code>）：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5   </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pytz                    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导入pytz模块用于处理时区</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize()失败，错误代码 =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置时区为UTC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">timezone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pytz.timezone(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Etc/UTC&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建一个UTC时区的datetime对象，以避免应用本地时区偏移</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">utc_from </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2022</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">tzinfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timezone)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从2022年1月10日（UTC时区）开始获取10根EURUSD H1周期的K线</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rates </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.copy_rates_from(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EURUSD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TIMEFRAME_H1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, utc_from, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示接收到的数据（元组）中的每个元素</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rates:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rate)</span></span></code></pre></div><p>接收数据示例：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>(1641567600, 1.12975, 1.13226, 1.12922, 1.13017, 8325, 0, 0)</span></span>
<span class="line"><span>(1641571200, 1.13017, 1.13343, 1.1299, 1.13302, 7073, 0, 0)</span></span>
<span class="line"><span>(1641574800, 1.13302, 1.13491, 1.13293, 1.13468, 5920, 0, 0)</span></span>
<span class="line"><span>(1641578400, 1.13469, 1.13571, 1.13375, 1.13564, 3723, 0, 0)</span></span>
<span class="line"><span>(1641582000, 1.13564, 1.13582, 1.13494, 1.13564, 1990, 0, 0)</span></span>
<span class="line"><span>(1641585600, 1.1356, 1.13622, 1.13547, 1.13574, 1269, 0, 0)</span></span>
<span class="line"><span>(1641589200, 1.13572, 1.13647, 1.13568, 1.13627, 1031, 0, 0)</span></span>
<span class="line"><span>(1641592800, 1.13627, 1.13639, 1.13573, 1.13613, 982, 0, 0)</span></span>
<span class="line"><span>(1641596400, 1.1361, 1.13613, 1.1358, 1.1359, 692, 1, 0)</span></span>
<span class="line"><span>(1641772800, 1.1355, 1.13597, 1.13524, 1.1356, 1795, 10, 0)</span></span></code></pre></div><ul><li><code>numpy.ndarray copy_rates_from_pos(symbol, timeframe, start, count)</code>：<code>copy_rates_from_pos</code>函数用于请求从指定起始索引<code>start</code>开始的<code>count</code>根K线数据。</li></ul><p>MetaTrader 5终端仅在用户图表上可用的历史数据范围内绘制K线。用户可用的K线数量在设置中通过“Max. bars in the window”（窗口中最大K线数）参数进行设置。</p><p>以下示例（<code>MQL5/Scripts/MQL5Book/Python/ratescorr.py</code>）展示了基于报价数据绘制几种货币的相关矩阵图。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导入pandas模块用于输出数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> matplotlib.pyplot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plt  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导入matplotlib模块用于绘图</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize()失败，错误代码 =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 在沙盒中创建用于保存结果图像的路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">image </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.terminal_info().data_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\M</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">QL5</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\F</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">iles</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\M</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">QL5Book</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\r</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">atescorr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 用于计算相关性的交易货币对列表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sym </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EURUSD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;GBPUSD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;USDJPY&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;USDCHF&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;AUDUSD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;USDCAD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;NZDUSD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;XAUUSD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将K线收盘价复制到DataFrame结构中</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sym:        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每个交易品种的最后1000根M1周期K线</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rates </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.copy_rates_from_pos(i, mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TIMEFRAME_M1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    d[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [y[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;close&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rates]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 计算价格变化百分比</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rets </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d.pct_change()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 计算相关性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">corr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rets.corr()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 绘制相关矩阵图</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plt.figure(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">figsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig.add_axes([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.imshow(corr, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cmap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;RdYlGn&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">interpolation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;none&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">aspect</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;equal&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.colorbar()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.xticks(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(corr)), corr.columns, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rotation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vertical&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.yticks(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(corr)), corr.columns)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.show()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.savefig(image)</span></span></code></pre></div><p>图像文件<code>ratescorr.png</code>会在当前运行的MetaTrader 5的沙盒中生成。如果你的Python安装中没有包含可选功能“tcl/tk and IDLE”，或者没有安装<code>pip install.tk</code>包，那么使用<code>plt.show()</code>在单独窗口中交互式显示图像的功能可能无法正常工作。</p><ul><li><code>numpy.ndarray copy_rates_range(symbol, timeframe, date_from, date_to)</code>：<code>copy_rates_range</code>函数用于获取指定日期和时间范围内的K线数据，范围是从<code>date_from</code>到<code>date_to</code>：这两个值都表示为自1970年开始的秒数，并且采用UTC时区（因为Python使用的<code>datetime</code>是本地时区，所以应该使用<code>pytz</code>模块进行转换）。结果包括开盘时间满足<code>time &gt;= date_from</code>且<code>time &lt;= date_to</code>的K线。</li></ul><p>在以下脚本中，我们将请求特定时间范围内的K线数据。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pytz             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导入pytz模块用于处理时区</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导入pandas模块用于以表格形式显示数据</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.set_option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display.max_columns&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置显示的最大列数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.set_option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display.width&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置显示的最大表格宽度</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize()失败，错误代码 =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置时区为UTC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">timezone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pytz.timezone(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Etc/UTC&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建UTC时区的datetime对象，以避免应用本地时区偏移</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">utc_from </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">tzinfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">timezone)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">utc_to </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">minute</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">tzinfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">timezone)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取2020年1月10日00:00 - 2020年1月10日00:30（UTC时区）期间USDJPY M5周期的K线数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rates </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.copy_rates_range(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;USDJPY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TIMEFRAME_M5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, utc_from, utc_to)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 根据接收到的数据创建DataFrame</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rates_frame </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(rates)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将时间从秒数转换为datetime格式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rates_frame[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.to_datetime(rates_frame[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">unit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输出数据</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rates_frame)</span></span></code></pre></div><p>结果示例：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>                 time     open     high      low    close  tick_volume  spread  real_volume </span></span>
<span class="line"><span>0 2020-01-10 00:00:00  109.513  109.527  109.505  109.521           43       2            0 </span></span>
<span class="line"><span>1 2020-01-10 00:05:00  109.521  109.549  109.518  109.543          215       8            0 </span></span>
<span class="line"><span>2 2020-01-10 00:10:00  109.543  109.543  109.466  109.505           98      10            0 </span></span>
<span class="line"><span>3 2020-01-10 00:15:00  109.504  109.534  109.502  109.517          155       8            0 </span></span>
<span class="line"><span>4 2020-01-10 00:20:00  109.517  109.539  109.513  109.527           71       4            0 </span></span>
<span class="line"><span>5 2020-01-10 00:25:00  109.526  109.537  109.484  109.520          106       9            0 </span></span>
<span class="line"><span>6 2020-01-10 00:30:00  109.520  109.524  109.508  109.510          205       7            0</span></span></code></pre></div><h2 id="读取tick历史数据" tabindex="-1">读取Tick历史数据 <a class="header-anchor" href="#读取tick历史数据" aria-label="Permalink to &quot;读取Tick历史数据&quot;">​</a></h2><p>Python API包含两个用于读取真实Tick历史数据的函数：<code>copy_ticks_from</code>和<code>copy_ticks_range</code>。<code>copy_ticks_from</code>可指定从特定日期开始的Tick数量来读取数据，<code>copy_ticks_range</code>则用于获取指定时间段内的所有Tick数据。</p><p>这两个函数都有四个必需的未命名参数，第一个参数指定交易品种，第二个参数指定请求的Tick数据的起始时间。第三个参数在<code>copy_ticks_from</code>函数中表示所需的Tick数量，在<code>copy_ticks_range</code>函数中表示Tick数据的结束时间。</p><p>最后一个参数决定返回的Tick数据类型，它可以包含以下标志之一（<code>COPY_TICKS</code>）：</p><table tabindex="0"><thead><tr><th>标识符</th><th>描述</th></tr></thead><tbody><tr><td><code>COPY_TICKS_ALL</code></td><td>所有Tick数据</td></tr><tr><td><code>COPY_TICKS_INFO</code></td><td>包含Bid和/或Ask价格变化的Tick数据</td></tr><tr><td><code>COPY_TICKS_TRADE</code></td><td>包含Last价格和/或交易量（Volume）变化的Tick数据</td></tr></tbody></table><p>两个函数都会将Tick数据作为<code>numpy.ndarray</code>（来自<code>numpy</code>包）数组返回，数组包含名为<code>time</code>、<code>bid</code>、<code>ask</code>、<code>last</code>和<code>flags</code>的列。<code>flags</code>字段的值是<code>TICK_FLAG</code>枚举中的位标志组合，每个位表示Tick属性中相应字段的变化。</p><table tabindex="0"><thead><tr><th>标识符</th><th>变化的Tick属性</th></tr></thead><tbody><tr><td><code>TICK_FLAG_BID</code></td><td>Bid价格</td></tr><tr><td><code>TICK_FLAG_ASK</code></td><td>Ask价格</td></tr><tr><td><code>TICK_FLAG_LAST</code></td><td>Last价格</td></tr><tr><td><code>TICK_FLAG_VOLUME</code></td><td>交易量</td></tr><tr><td><code>TICK_FLAG_BUY</code></td><td>最后买入价格</td></tr><tr><td><code>TICK_FLAG_SELL</code></td><td>最后卖出价格</td></tr></tbody></table><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">numpy.ndarray copy_ticks_from(symbol, date_from, count, flags)</span></span></code></pre></div><p><code>copy_ticks_from</code>函数从指定时间（<code>date_from</code>）开始按给定数量（<code>count</code>）请求Tick数据，它类似于MQL5中的<code>CopyTicks</code>函数。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">numpy.array copy_ticks_range(symbol, date_from, date_to, flags)</span></span></code></pre></div><p><code>copy_ticks_range</code>函数用于获取指定时间范围内的Tick数据，类似于MQL5中的<code>CopyTicksRange</code>函数。</p><p>以下是一个示例代码（MQL5/Scripts/MQL5Book/Python/copyticks.py），它会生成一个带有Tick数据图表的交互式网页（注意：这里使用了<code>plotly</code>包，若要在Python中安装该包，可运行命令<code>pip install plotly</code>）：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pytz</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 连接到终端</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置保存到沙盒的文件名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.terminal_info().data_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\M</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">QL5</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\F</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">iles</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\M</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">QL5Book</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\c</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">opyticks</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">html</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从历史中的特定时刻复制1000个EURUSD的Tick数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">utc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pytz.timezone(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Etc/UTC&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rates </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.copy_ticks_from(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EURUSD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datetime(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2022</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">tzinfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utc), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COPY_TICKS_ALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [x[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bid&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rates]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [x[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ask&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rates]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [x[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rates]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.to_datetime(time, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">unit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导入绘图包并在网页上绘制Ask和Bid价格的两条曲线</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plotly.graph_objs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> go</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plotly.offline </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> download_plotlyjs, init_notebook_mode, plot, iplot</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [go.Scatter(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bid), go.Scatter(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ask)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plot(data, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">filename</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> path)</span></span></code></pre></div><p>运行上述代码后，会生成一个包含Ask和Bid价格随时间变化曲线的交互式网页。该网页会保存在指定的路径下，你可以在浏览器中打开查看。</p><h2 id="计算保证金要求和评估利润" tabindex="-1">计算保证金要求和评估利润 <a class="header-anchor" href="#计算保证金要求和评估利润" aria-label="Permalink to &quot;计算保证金要求和评估利润&quot;">​</a></h2><p>Python开发者可以在脚本中使用<code>order_calc_margin</code>和<code>order_calc_profit</code>函数直接计算拟进行的交易操作所需的保证金以及潜在的利润或亏损。如果函数执行成功，其结果为一个实数；否则，返回<code>None</code>。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> order_calc_margin(action, symbol, volume, price)</span></span></code></pre></div><p><code>order_calc_margin</code>函数返回完成指定交易操作<code>action</code>所需的保证金金额（以账户货币为单位）。<code>action</code>可以是<code>ENUM_ORDER_TYPE</code>枚举中的两个元素之一：<code>ORDER_TYPE_BUY</code>（买入订单类型）或<code>ORDER_TYPE_SELL</code>（卖出订单类型）。后续参数分别指定金融工具的名称、交易操作的交易量以及开仓价格。</p><p>此函数是MQL5中<code>OrderCalcMargin</code>函数的Python版本。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> order_calc_profit(action, symbol, volume, price_open, price_close)</span></span></code></pre></div><p><code>order_calc_profit</code>函数返回指定交易类型、交易品种、交易量以及市场进出价格差所对应的利润或亏损金额（以账户货币为单位）。</p><p>此函数是MQL5中<code>OrderCalcProfit</code>函数的Python版本。</p><p>建议在发送订单之前，检查交易操作所需的保证金以及预期结果。</p><p>以下是一个简单的示例代码，展示如何使用这两个函数：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 初始化连接到MetaTrader 5终端</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 定义交易参数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">action </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_TYPE_BUY</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">symbol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;EURUSD&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">volume </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">price_open </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.1200</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">price_close </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.1210</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 计算保证金</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">margin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.order_calc_margin(action, symbol, volume, price_open)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> margin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;交易所需保证金: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">margin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 账户货币&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;计算保证金时出错:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 计算利润</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">profit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.order_calc_profit(action, symbol, volume, price_open, price_close)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> profit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;预期利润: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">profit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 账户货币&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;计算利润时出错:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 关闭与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><p>在上述示例中，我们首先初始化与MetaTrader 5终端的连接，然后定义了交易的相关参数，包括交易类型、交易品种、交易量、开仓价格和预期平仓价格。接着，我们分别调用<code>order_calc_margin</code>和<code>order_calc_profit</code>函数来计算保证金和预期利润，并对可能出现的错误进行了处理。最后，关闭了与终端的连接。</p><h2 id="检查并发送交易订单" tabindex="-1">检查并发送交易订单 <a class="header-anchor" href="#检查并发送交易订单" aria-label="Permalink to &quot;检查并发送交易订单&quot;">​</a></h2><p>如果有需要，你可以直接从Python脚本中进行交易。<code>order_check</code>和<code>order_send</code>这两个函数可以让你先对交易操作进行预检查，然后再执行该交易操作。</p><p>对于这两个函数，唯一的参数都是交易请求结构体<code>TradeRequest</code>（在Python中可以初始化为字典，见示例）。该结构体的字段与<code>MqlTradeRequest</code>完全相同。</p><h4 id="_1-order-check-request" tabindex="-1">1. <code>order_check(request)</code> <a class="header-anchor" href="#_1-order-check-request" aria-label="Permalink to &quot;1. `order_check(request)`&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OrderCheckResult order_check(request)</span></span></code></pre></div><p><code>order_check</code>函数用于检查交易请求字段的正确性以及资金是否足以完成所需的交易操作。</p><p>该函数的结果以<code>OrderCheckResult</code>结构体的形式返回。它与<code>MqlTradeCheckResult</code>的结构相同，但额外包含<code>request</code>字段，其中存储了原始请求的副本。</p><p><code>order_check</code>函数是MQL5中<code>OrderCheck</code>函数的等效函数。</p><p>示例（<code>MQL5/Scripts/MQL5Book/python/ordercheck.py</code>）：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取账户货币信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">account_currency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.account_info().currency</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Account currency:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, account_currency)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取交易品种的必要属性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">symbol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;USDJPY&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">symbol_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info(symbol)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(symbol, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;not found, can not call order_check()&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">point </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info(symbol).point</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 如果该交易品种在市场报价窗口中不可用，则添加它</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_info.visible:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(symbol, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;is not visible, trying to switch on&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_select(symbol, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;symbol_select(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) failed, exit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, symbol)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将请求结构体准备为字典形式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TRADE_ACTION_DEAL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;symbol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: symbol,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;volume&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_TYPE_BUY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;price&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.symbol_info_tick(symbol).ask,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;sl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.symbol_info_tick(symbol).ask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> point,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;tp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.symbol_info_tick(symbol).ask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> point,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;deviation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;magic&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">234000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;comment&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;python script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type_time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_TIME_GTC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type_filling&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_FILLING_RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 运行测试并直接显示结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.order_check(request)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result)                       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># [?这不在帮助日志中?]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将结果转换为字典并逐个输出元素</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> field </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result_dict.keys():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(field, result_dict[field]))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 如果这是交易请求结构体，则也逐个输出其元素</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> field </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        traderequest_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result_dict[field]._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tradereq_filed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> traderequest_dict:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;       traderequest: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(tradereq_filed,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            traderequest_dict[tradereq_filed]))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 终止与终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><h3 id="结果" tabindex="-1">结果： <a class="header-anchor" href="#结果" aria-label="Permalink to &quot;结果：&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>Account currency: USD</span></span>
<span class="line"><span></span></span>
<span class="line"><span>OrderCheckResult(retcode=0, balance=10000.17, equity=10000.17, profit=0.0, margin=1000.0,...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   retcode=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   balance=10000.17</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   equity=10000.17</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   profit=0.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   margin=1000.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   margin_free=9000.17</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   margin_level=1000.017</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   comment=Done</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   request=TradeRequest(action=1, magic=234000, order=0, symbol=&#39;USDJPY&#39;, volume=1.0, price=144.128,...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: action=1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: magic=234000</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: order=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: symbol=USDJPY</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: volume=1.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: price=144.128</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: stoplimit=0.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: sl=144.028</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: tp=144.228</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: deviation=10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: type=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: type_filling=2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: type_time=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: expiration=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: comment=python script</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: position=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: position_by=0</span></span></code></pre></div><h4 id="_2-order-send-request" tabindex="-1">2. <code>order_send(request)</code> <a class="header-anchor" href="#_2-order-send-request" aria-label="Permalink to &quot;2. `order_send(request)`&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OrderSendResult order_send(request)</span></span></code></pre></div><p><code>order_send</code>函数将来自终端的交易请求发送到交易服务器，以执行交易操作。</p><p>该函数的结果以<code>OrderSendResult</code>结构体的形式返回。它与<code>MqlTradeResult</code>的结构相同，但额外包含<code>request</code>字段，其中存储了原始请求的副本。</p><p>该函数是MQL5中<code>OrderSend</code>函数的等效函数。</p><p>示例（<code>MQL5/Scripts/MQL5Book/python/ordersend.py</code>）：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5 </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 指定交易品种的属性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">symbol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;USDJPY&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">symbol_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info(symbol)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(symbol, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;not found, can not trade&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 如果该交易品种在市场报价窗口中不可用，则添加它</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> symbol_info.visible:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(symbol, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;is not visible, trying to switch on&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_select(symbol, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;symbol_select(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) failed, exit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, symbol)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 准备买入的请求结构体</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">point </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info(symbol).point</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info_tick(symbol).ask</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deviation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TRADE_ACTION_DEAL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;symbol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: symbol, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;volume&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: lot, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_TYPE_BUY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;price&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: price, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;sl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> point, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;tp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> point, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;deviation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: deviation, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;magic&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">234000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;comment&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;python script open&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type_time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_TIME_GTC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type_filling&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_FILLING_RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发送开仓的交易请求</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.order_send(request)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查执行结果</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1. order_send(): by </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> {}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lots at </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(symbol, lot, price))</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result.retcode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TRADE_RETCODE_DONE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2. order_send failed, retcode=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(result.retcode))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 将结果请求为字典并逐个显示元素</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> field </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result_dict.keys():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(field, result_dict[field]))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 如果这是交易请求结构体，则也逐个输出其元素</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> field </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            traderequest_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result_dict[field]._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tradereq_filed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> traderequest_dict: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;       traderequest: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(tradereq_filed,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                traderequest_dict[tradereq_filed]))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;shutdown() and quit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mt5.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2. order_send done, &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, result)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;   opened position with POSITION_TICKET=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(result.order))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;   sleep 2 seconds before closing position #</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(result.order))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time.sleep(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建平仓请求</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">position_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result.order</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.symbol_info_tick(symbol).bid</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TRADE_ACTION_DEAL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;symbol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: symbol, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;volume&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: lot, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_TYPE_SELL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;position&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: position_id, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;price&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: price, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;deviation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: deviation, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;magic&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">234000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;comment&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;python script close&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type_time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_TIME_GTC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type_filling&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ORDER_FILLING_RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发送平仓的交易请求</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.order_send(request)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查执行结果</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3. close position #</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">: sell </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> {}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lots at </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(position_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">symbol, lot, price))</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result.retcode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TRADE_RETCODE_DONE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;4. order_send failed, retcode=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(result.retcode))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;   result&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, result)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;4. position #</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> closed, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(position_id, result))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 将结果请求为字典并逐个显示元素</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> field </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result_dict.keys():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(field, result_dict[field])) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 如果这是交易请求结构体，则也逐个输出其元素</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> field </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            traderequest_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result_dict[field]._asdict()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tradereq_filed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> traderequest_dict:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;       traderequest: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(tradereq_filed,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                traderequest_dict[tradereq_filed]))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 终止与终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><h3 id="结果-1" tabindex="-1">结果： <a class="header-anchor" href="#结果-1" aria-label="Permalink to &quot;结果：&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>1. order_send(): by USDJPY 0.1 lots at 144.132</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. order_send done,  OrderSendResult(retcode=10009, deal=1445796125, order=1468026008, volume=0.1, price=144.132,...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   opened position with POSITION_TICKET=1468026008</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   sleep 2 seconds before closing position #1468026008</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. close position #1468026008: sell USDJPY 0.1 lots at 144.124</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. position #1468026008 closed, OrderSendResult(retcode=10009, deal=1445796155, order=1468026041, volume=0.1, price=144.124,...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   retcode=10009</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   deal=1445796155</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   order=1468026041</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   volume=0.1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   price=144.124</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   bid=144.124</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   ask=144.132</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   comment=Request executed</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   request_id=2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   retcode_external=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   request=TradeRequest(action=1, magic=234000, order=0, symbol=&#39;USDJPY&#39;, volume=0.1, price=144.124, stoplimit=0.0,...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: action=1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: magic=234000</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: order=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: symbol=USDJPY</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: volume=0.1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: price=144.124</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: stoplimit=0.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: sl=0.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: tp=0.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: deviation=20</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: type=1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: type_filling=2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: type_time=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: expiration=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: comment=python script close</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: position=1468026008</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       traderequest: position_by=0</span></span></code></pre></div><h2 id="获取活跃订单数量及列表" tabindex="-1">获取活跃订单数量及列表 <a class="header-anchor" href="#获取活跃订单数量及列表" aria-label="Permalink to &quot;获取活跃订单数量及列表&quot;">​</a></h2><p>Python API提供了以下用于处理活跃订单的函数。</p><ul><li><code>int orders_total()</code>：<code>orders_total</code>函数返回活跃订单的数量。该函数类似于MQL5中的<code>OrdersTotal</code>函数。</li><li><code>namedtuple[] orders_get()</code></li><li><code>namedtuple[] orders_get(symbol = &lt;&quot;SYMBOL&quot;&gt;)</code></li><li><code>namedtuple[] orders_get(group = &lt;&quot;PATTERN&quot;&gt;)</code></li><li><code>namedtuple[] orders_get(ticket = &lt;TICKET&gt;)</code></li></ul><p>可以使用<code>orders_get</code>函数获取每个订单的详细信息，该函数有多种选项，能够按交易品种或订单号进行筛选。无论哪种方式，该函数都会返回命名元组<code>TradeOrder</code>的数组（字段名与<code>ENUM_ORDER_PROPERTY_</code>枚举中的名称相对应，但去掉了“ORDER_”前缀并转换为小写）。如果发生错误，结果为<code>None</code>。</p><p>不带参数的<code>orders_get</code>函数会返回所有交易品种的订单。可选的命名参数<code>symbol</code>可用于指定特定的交易品种名称来筛选订单。可选的命名参数<code>group</code>用于使用通配符“*”（可替代模式中任意数量的任意字符，包括零个字符）和条件逻辑否定字符“!”指定搜索模式。过滤器模板的操作原理在“获取金融工具信息”部分有描述 。如果指定了<code>ticket</code>参数，则会搜索特定的订单。通过一次函数调用，你可以获取所有活跃订单。这类似于MQL5中<code>OrdersTotal</code>、<code>OrderSelect</code>和<code>OrderGet</code>函数的组合使用。</p><p>在接下来的示例（<code>MQL5/Scripts/MQL5Book/Python/ordersget.py</code>）中，我们通过不同方式请求订单信息。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.set_option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display.max_columns&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置显示的最大列数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.set_option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display.width&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置显示的最大表格宽度</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize(): </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize()失败，错误代码 =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示GBPUSD交易品种上活跃订单的信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.orders_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">symbol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;GBPUSD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GBPUSD上无订单，错误代码=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(mt5.last_error()))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GBPUSD上的订单总数:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(orders))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 显示所有活跃订单</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> order </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(order)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取名称中包含“*GBP*”的交易品种的订单列表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gbp_orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.orders_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">group</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*GBP*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gbp_orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;没有group=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*GBP*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">的订单，错误代码=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(mt5.last_error()))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;orders_get(group=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*GBP*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gbp_orders)))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 使用pandas.DataFrame将订单显示为表格</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gbp_orders), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gbp_orders[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]._asdict().keys())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    df.drop([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_done&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_done_msc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;position_id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;position_by_id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;reason&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;volume_initial&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;price_stoplimit&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">inplace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_setup&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.to_datetime(df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_setup&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">unit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><p>示例结果如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>GBPUSD上的订单总数: 2 </span></span>
<span class="line"><span>TradeOrder(ticket=554733548, time_setup=1585153667, time_setup_msc=1585153667718, time_done=0, time_done_msc=0, time_expiration=0, type=3, type_time=0, ... </span></span>
<span class="line"><span>TradeOrder(ticket=554733621, time_setup=1585153671, time_setup_msc=1585153671419, time_done=0, time_done_msc=0, time_expiration=0, type=2, type_time=0, ... </span></span>
<span class="line"><span></span></span>
<span class="line"><span>orders_get(group=&quot;*GBP*&quot;)=4 </span></span>
<span class="line"><span>      ticket          time_setup  time_setup_msc  type ... volume_current  price_open   sl   tp  price_current  symbol comment external_id </span></span>
<span class="line"><span>0  554733548 2020-03-25 16:27:47   1585153667718     3 ...            0.2     1.25379  0.0  0.0        1.16803  GBPUSD                     </span></span>
<span class="line"><span>1  554733621 2020-03-25 16:27:51   1585153671419     2 ...            0.2     1.14370  0.0  0.0        1.16815  GBPUSD                     </span></span>
<span class="line"><span>2  554746664 2020-03-25 16:38:14   1585154294401     3 ...            0.2     0.93851  0.0  0.0        0.92428  EURGBP                     </span></span>
<span class="line"><span>3  554746710 2020-03-25 16:38:17   1585154297022     2 ...            0.2     0.90527  0.0  0.0        0.92449  EURGBP</span></span></code></pre></div><h2 id="获取未平仓头寸的数量和列表" tabindex="-1">获取未平仓头寸的数量和列表 <a class="header-anchor" href="#获取未平仓头寸的数量和列表" aria-label="Permalink to &quot;获取未平仓头寸的数量和列表&quot;">​</a></h2><p><code>positions_total</code>函数用于返回未平仓头寸的数量。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> positions_total()</span></span></code></pre></div><p>该函数是MQL5中<code>PositionsTotal</code>函数的对应函数。</p><p>若要获取每个头寸的详细信息，可以使用<code>positions_get</code>函数，它有多种调用方式。所有变体都会返回一个具名元组<code>TradePosition</code>的数组，其键对应头寸的属性（请参阅<code>ENUM_POSITION_PROPERTY</code>枚举中的元素，去掉“POSITION_”前缀并转换为小写）。如果出现错误，结果将为<code>None</code>。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">namedtuple[] positions_get()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">namedtuple[] positions_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">symbol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SYMBOL&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">namedtuple[] positions_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">group</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PATTERN&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">namedtuple[] positions_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ticket</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TICKET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>不带参数调用该函数时，将返回所有未平仓头寸。</p><p>带有<code>symbol</code>参数的函数可以选择指定交易品种的头寸。</p><p>带有<code>group</code>参数的函数可通过带有通配符<code>*</code>（可替换任意字符）和条件逻辑非<code>!</code>的搜索掩码进行筛选。有关详细信息，请参阅“获取金融工具信息”部分。</p><p>带有<code>ticket</code>参数的版本会选择具有特定订单号（<code>POSITION_TICKET</code>属性）的头寸。</p><p><code>positions_get</code>函数可在一次调用中获取所有头寸及其属性，这使其类似于<code>PositionsTotal</code>、<code>PositionSelect</code>和<code>PositionGet</code>函数的组合。</p><p>在脚本<code>MQL5/Scripts/MQL5Book/Python/positionsget.py</code>中，我们请求特定交易品种和搜索掩码下的头寸。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.set_option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display.max_columns&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示的最大列数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.set_option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display.width&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示的最大表格宽度</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建立与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.initialize():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;initialize() failed, error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取USDCHF的未平仓头寸</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">positions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.positions_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">symbol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;USDCHF&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> positions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;No positions on USDCHF, error code=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(mt5.last_error()))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">elif</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(positions) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Total positions on USDCHF =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(positions))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 显示所有未平仓头寸</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> positions:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取名称中包含“*USD*”的交易品种的头寸列表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">usd_positions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.positions_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">group</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;*USD*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> usd_positions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;No positions with group=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*USD*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, error code=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(mt5.last_error())) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">elif</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(usd_positions) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;positions_get(group=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*USD*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(usd_positions)))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 使用pandas.DataFrame将头寸显示为表格</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.DataFrame(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(usd_positions), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> usd_positions[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]._asdict().keys())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.to_datetime(df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">unit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df.drop([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_update&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_msc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_update_msc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;external_id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">   axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">inplace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 断开与MetaTrader 5终端的连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.shutdown()</span></span></code></pre></div><p>结果可能如下所示：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>Total positions on USDCHF = 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TradePosition(ticket=1468454363, time=1664217233, time_msc=1664217233239, time_update=1664217233,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   time_update_msc=1664217233239, type=1, magic=0, identifier=1468454363, reason=0, volume=0.01, price_open=0.99145,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   sl=0.0, tp=0.0, price_current=0.9853, swap=-0.01, profit=6.24, symbol=&#39;USDCHF&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>positions_get(group=&quot;*USD*&quot;) = 2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>       ticket                time  type  ...  identifier  volume  price_open  ... _current  swap  profit  symbol comment</span></span>
<span class="line"><span></span></span>
<span class="line"><span>0  1468454363 2022-09-26 18:33:53     1  ...  1468454363    0.01     0.99145  ...  0.98530 -0.01    6.24  USDCHF        </span></span>
<span class="line"><span></span></span>
<span class="line"><span>1  1468475849 2022-09-26 18:44:00     0  ...  1468475849    0.01     1.06740  ...  1.08113  0.00   13.73  GBPUSD</span></span></code></pre></div><h2 id="读取订单和交易记录的历史数据" tabindex="-1">读取订单和交易记录的历史数据 <a class="header-anchor" href="#读取订单和交易记录的历史数据" aria-label="Permalink to &quot;读取订单和交易记录的历史数据&quot;">​</a></h2><p>使用Python脚本处理账户历史记录中的订单和交易也是可行的。为此，有<code>history_orders_total</code>、<code>history_orders_get</code>、<code>history_deals_total</code>和<code>history_deals_get</code>这些函数。</p><p><strong><code>int history_orders_total(date_from, date_to)</code></strong></p><p><code>history_orders_total</code>函数返回指定时间间隔内交易历史记录中的订单数量。每个参数可以通过<code>datetime</code>对象设置，也可以设置为自1970年1月1日以来的秒数。</p><p>该函数是<code>HistoryOrdersTotal</code>的一个类似函数。</p><p><code>history_orders_get</code>函数有多个版本，支持通过交易品种名称中的子字符串、订单号或仓位ID来过滤订单。所有版本都返回一个命名元组<code>TradeOrder</code>的数组（字段名称与<code>ENUM_ORDER_PROPERTY</code>枚举中的名称匹配，去掉了“ORDER_”前缀并采用小写形式）。如果没有匹配的订单，数组将为空。如果出现错误，函数将返回<code>None</code>。</p><p><strong><code>namedtuple[] history_orders_get(date_from, date_to, group = &lt;&quot;PATTERN&quot;&gt;)</code></strong></p><p><strong><code>namedtuple[] history_orders_get(ticket = &lt;ORDER_TICKET&gt;)</code></strong></p><p><strong><code>namedtuple[] history_orders_get(position = &lt;POSITION_ID&gt;)</code></strong></p><p>第一个版本在指定的时间范围内选择订单（类似于<code>history_orders_total</code>）。在可选的命名参数<code>group</code>中，你可以指定一个交易品种名称子字符串的搜索模式（可以在其中使用通配符“*”和否定符“!”，请参阅获取金融工具信息的部分）。</p><p>第二个版本用于通过订单号搜索特定的订单。</p><p>最后一个版本通过仓位ID（<code>ORDER_POSITION_ID</code>属性）选择订单。</p><p>任何一个选项都等同于调用几个MQL5函数：<code>HistoryOrdersTotal</code>、<code>HistoryOrderSelect</code>和<code>HistoryOrderGet</code>函数。</p><p>让我们看一个名为<code>historyordersget.py</code>的脚本示例，了解如何根据不同条件获取历史订单的数量和列表。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MetaTrader5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.set_option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display.max_columns&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示的列数 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.set_option(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display.width&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示的表格最大宽度</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取指定时间段内历史记录中的订单数量（总数以及包含*GBP*的订单数量）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">from_date </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2022</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">to_date </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime.now()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">total </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.history_orders_total(from_date, to_date)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">history_orders</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mt5.history_orders_get(from_date, to_date, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">group</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*GBP*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># print(history_orders)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> history_orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;No history orders with group=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*GBP*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, error code=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(mt5.last_error())) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;history_orders_get(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, group=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*GBP*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of total </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(from_date,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   to_date, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(history_orders), total))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 显示仓位ID为0的所有已取消的历史订单</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">position_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">position_history_orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.history_orders_get(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">position</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> position_id)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> position_history_orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;No orders with position #</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(position_id))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error code =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mt5.last_error())</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">elif</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position_history_orders) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Total history orders on position #</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(position_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position_history_orders)))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 按原样显示获取到的订单</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> position_order </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> position_history_orders:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position_order)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 使用pandas.DataFrame将这些订单显示为表格</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position_history_orders),</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">   columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> position_history_orders[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]._asdict().keys())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df.drop([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_expiration&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;type_time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;state&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;position_by_id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;reason&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;volume_current&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   &#39;price_stoplimit&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sl&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tp&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_setup_msc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_done_msc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;type_filling&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;external_id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">   axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">inplace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_setup&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.to_datetime(df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_setup&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">unit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_done&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.to_datetime(df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_done&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">unit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></div><p>该脚本的运行结果（部分内容缩写显示）：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>history_orders_get(2022-09-01 00:00:00, 2022-09-26 21:50:04, group=&quot;*GBP*&quot;)=15 of total 44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Total history orders on position #0: 14</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TradeOrder(ticket=1437318706, time_setup=1661348065, time_setup_msc=1661348065049, time_done=1661348083,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   time_done_msc=1661348083632, time_expiration=0, type=2, type_time=0, type_filling=2, state=2, magic=0,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   position_id=0, position_by_id=0, reason=3, volume_initial=0.01, volume_current=0.01, price_open=0.99301,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   sl=0.0, tp=0.0, price_current=0.99311, price_stoplimit=0.0, symbol=&#39;EURUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TradeOrder(ticket=1437331579, time_setup=1661348545, time_setup_msc=1661348545750, time_done=1661348551,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   time_done_msc=1661348551354, time_expiration=0, type=2, type_time=0, type_filling=2, state=2, magic=0,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   position_id=0, position_by_id=0, reason=3, volume_initial=0.01, volume_current=0.01, price_open=0.99281,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   sl=0.0, tp=0.0, price_current=0.99284, price_stoplimit=0.0, symbol=&#39;EURUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TradeOrder(ticket=1437331739, time_setup=1661348553, time_setup_msc=1661348553935, time_done=1661348563,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   time_done_msc=1661348563412, time_expiration=0, type=2, type_time=0, type_filling=2, state=2, magic=0,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   position_id=0, position_by_id=0, reason=3, volume_initial=0.01, volume_current=0.01, price_open=0.99285,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   sl=0.0, tp=0.0, price_current=0.99286, price_stoplimit=0.0, symbol=&#39;EURUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>        ticket          time_setup           time_done  type  ... _initial  price_open  price_current  symbol comment</span></span>
<span class="line"><span></span></span>
<span class="line"><span>0   1437318706 2022-08-24 13:34:25 2022-08-24 13:34:43     2          0.01     0.99301        0.99311  EURUSD        </span></span>
<span class="line"><span></span></span>
<span class="line"><span>1   1437331579 2022-08-24 13:42:25 2022-08-24 13:42:31     2          0.01     0.99281        0.99284  EURUSD        </span></span>
<span class="line"><span></span></span>
<span class="line"><span>2   1437331739 2022-08-24 13:42:33 2022-08-24 13:42:43     2          0.01     0.99285        0.99286  EURUSD</span></span>
<span class="line"><span></span></span>
<span class="line"><span>...</span></span></code></pre></div><p>我们可以看到，在9月份，只有44笔订单，其中15笔订单涉及英镑货币（由于有未平仓头寸，这个数字有些奇怪）。历史记录中有14笔已取消的订单。</p><p><strong><code>int history_deals_total(date_from, date_to)</code></strong></p><p><code>history_deals_total</code>函数返回指定时间段内历史记录中的交易数量。</p><p>该函数是<code>HistoryDealsTotal</code>的一个类似函数。</p><p><code>history_deals_get</code>函数有几种形式，用于选择交易记录，并能够通过订单号或仓位ID进行过滤。该函数的所有形式都返回一个命名元组<code>TradeDeal</code>的数组，其字段反映了<code>ENUM_DEAL_PROPERTY</code>枚举中的属性（字段名称去掉了“DEAL_”前缀并采用小写形式）。如果出现错误，将得到<code>None</code>。</p><p><strong><code>namedtuple[] history_deals_get(date_from, date_to, group = &lt;&quot;PATTERN&quot;&gt;)</code></strong></p><p><strong><code>namedtuple[] history_deals_get(ticket = &lt;ORDER_TICKET&gt;)</code></strong></p><p><strong><code>namedtuple[] history_deals_get(position = &lt;POSITION_ID&gt;)</code></strong></p><p>该函数的第一种形式类似于使用<code>history_orders_get</code>来请求历史订单。</p><p>第二种形式允许通过特定订单的订单号（<code>DEAL_ORDER</code>属性）来选择该订单产生的交易。</p><p>最后，第三种形式请求那些形成了具有给定ID的仓位的交易（<code>DEAL_POSITION_ID</code>属性）。</p><p>该函数允许在一次调用中获取所有交易及其属性，这等同于调用一系列<code>HistoryDealsTotal</code>、<code>HistoryDealSelect</code>和<code>HistoryDealGet</code>函数。</p><p>以下是测试脚本<code>historydealsget.py</code>的主要部分。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置时间范围</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">from_date </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">to_date </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> datetime.now() </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取交易品种名称中既不包含“EUR”也不包含“GBP”的交易记录</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deals </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mt5.history_deals_get(from_date, to_date, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">group</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*,!*EUR*,!*GBP*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deals </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;No deals, error code=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.format(mt5.last_error()))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">elif</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(deals) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;history_deals_get(from_date, to_date, group=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*,!*EUR*,!*GBP*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) =&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(deals)) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 按原样显示所有获取到的交易记录</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deals: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;  &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,deal) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 使用pandas.DataFrame将这些交易显示为表格</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(deals), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deals[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]._asdict().keys()) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.to_datetime(df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">unit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   df.drop([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time_msc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;commission&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;fee&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">inplace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df)</span></span></code></pre></div><p>结果示例：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>history_deals_get(from_date, to_date, group=&quot;*,!*EUR*,!*GBP*&quot;) = 12</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1109160642, order=0, time=1632188460, time_msc=1632188460852, type=2, entry=0, magic=0, position_id=0, reason=0, volume=0.0, price=0.0, commission=0.0, swap=0.0, profit=10000.0, fee=0.0, symbol=&#39;&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1250629232, order=1268074569, time=1645709385, time_msc=1645709385815, type=0, entry=0, magic=0, position_id=1268074569, reason=0, volume=0.01, price=1970.98, commission=0.0, swap=0.0, profit=0.0, fee=0.0, symbol=&#39;XAUUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1250639814, order=1268085019, time=1645709950, time_msc=1645709950618, type=1, entry=1, magic=0, position_id=1268074569, reason=0, volume=0.01, price=1970.09, commission=0.0, swap=0.0, profit=-0.89, fee=0.0, symbol=&#39;XAUUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1250639928, order=1268085129, time=1645709955, time_msc=1645709955502, type=1, entry=0, magic=0, position_id=1268085129, reason=0, volume=0.01, price=1969.98, commission=0.0, swap=0.0, profit=0.0, fee=0.0, symbol=&#39;XAUUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1250640111, order=1268085315, time=1645709965, time_msc=1645709965148, type=0, entry=1, magic=0, position_id=1268085129, reason=0, volume=0.01, price=1970.17, commission=0.0, swap=0.0, profit=-0.19, fee=0.0, symbol=&#39;XAUUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1250640309, order=1268085512, time=1645709973, time_msc=1645709973623, type=1, entry=0, magic=0, position_id=1268085512, reason=0, volume=0.1, price=1970.09, commission=0.0, swap=0.0, profit=0.0, fee=0.0, symbol=&#39;XAUUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1250640400, order=1268085611, time=1645709978, time_msc=1645709978701, type=0, entry=1, magic=0, position_id=1268085512, reason=0, volume=0.1, price=1970.22, commission=0.0, swap=0.0, profit=-1.3, fee=0.0, symbol=&#39;XAUUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1250640616, order=1268085826, time=1645709988, time_msc=1645709988277, type=1, entry=0, magic=0, position_id=1268085826, reason=0, volume=1.1, price=1969.95, commission=0.0, swap=0.0, profit=0.0, fee=0.0, symbol=&#39;XAUUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1250640810, order=1268086019, time=1645709996, time_msc=1645709996990, type=0, entry=1, magic=0, position_id=1268085826, reason=0, volume=1.1, price=1969.88, commission=0.0, swap=0.0, profit=7.7, fee=0.0, symbol=&#39;XAUUSD&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1445796125, order=1468026008, time=1664199450, time_msc=1664199450488, type=0, entry=0, magic=234000, position_id=1468026008, reason=3, volume=0.1, price=144.132, commission=0.0, swap=0.0, profit=0.0, fee=0.0, symbol=&#39;USDJPY&#39;, comment=&#39;python script op&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1445796155, order=1468026041, time=1664199452, time_msc=1664199452567, type=1, entry=1, magic=234000, position_id=1468026008, reason=3, volume=0.1, price=144.124, commission=0.0, swap=0.0, profit=-0.56, fee=0.0, symbol=&#39;USDJPY&#39;, comment=&#39;python script cl&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   TradeDeal(ticket=1446217804, order=1468454363, time=1664217233, time_msc=1664217233239, type=1, entry=0, magic=0, position_id=1468454363, reason=0, volume=0.01, price=0.99145, commission=0.0, swap=0.0, profit=0.0, fee=0.0, symbol=&#39;USDCHF&#39;, comment=&#39;&#39;, external_id=&#39;&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>        ticket       order                time t  e   position_id  volume       price    profit  symbol  comment external_id</span></span>
<span class="line"><span></span></span>
<span class="line"><span>0   1109160642           0 2021-09-21 01:41:00  2   0              0    0.00     0.00000  10000.00                             </span></span>
<span class="line"><span></span></span>
<span class="line"><span>1   1250629232  1268074569 2022-02-24 13:29:45  0   0     1268074569    0.01  1970.98000      0.00  XAUUSD                     </span></span>
<span class="line"><span></span></span>
<span class="line"><span>2   1250639814  1268085019 2022-02-24 13:39:10  1   1     1268074569    0.01  1970.09000     -0.89  XAUUSD                     </span></span>
<span class="line"><span></span></span>
<span class="line"><span>3   1250639928  1268085129 2022-02-24 13:39:15  1   0     1268085129    0.01  1969.98000      0.00  XAUUSD                     </span></span>
<span class="line"><span></span></span>
<span class="line"><span>4   1250640111  1268085315 2022-02-24 13:39:25  0   1     1268085129    0.01  1970.17000     -0.19  XAUUSD                     </span></span>
<span class="line"><span></span></span>
<span class="line"><span>5   1250640309  1268085512 2022-02-24 13:39:33  1   0     1268085512    0.10  1970.09000      0.00  XAUUSD                     </span></span>
<span class="line"><span></span></span>
<span class="line"><span>6   1250640400  1268085611 2022-02-24 13:39:38  0   1     1268085512    0.10  1970.22000     -1.30  XAUUSD                     </span></span>
<span class="line"><span></span></span>
<span class="line"><span>7   1250640616  1268085826 2022-02-24 13:39:48  1   0     1268085826    1.10  1969.95000      0.00  XAUUSD                     </span></span>
<span class="line"><span></span></span>
<span class="line"><span>8   1250640810  1268086019 2022-02-24 13:39:56  0   1     1268085826    1.10  1969.88000      7.70  XAUUSD                     </span></span>
<span class="line"><span></span></span>
<span class="line"><span>9   1445796125  1468026008 2022-09-26 13:37:30  0   0     1468026008    0.10   144.13200      0.00  USDJPY  python script op   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>10  1445796155  1468026041 2022-09-26 13:37:32  1   1     1468026008    0.10   144.12400     -0.56  USDJPY  python script cl   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>11  1446217804  1468454363 2022-09-26 18:33:53  1   0     1468454363    0.01     0.99145      0.00  USDCHF</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-c23ecb28 data-v-7e27a434><!--[--><!--]--><div class="edit-info" data-v-7e27a434><!----><div class="last-updated" data-v-7e27a434><p class="VPLastUpdated" data-v-7e27a434 data-v-205198a3>最近更新: <time datetime="2025-04-11T15:58:41.000Z" data-v-205198a3></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-7e27a434><span class="visually-hidden" id="doc-footer-aria-label" data-v-7e27a434>Pager</span><div class="pager" data-v-7e27a434><a class="VPLink link pager-link prev" href="/mq5_programming_for_traders/advanced_language_tools/projects" data-v-7e27a434><!--[--><span class="desc" data-v-7e27a434>上一页</span><span class="title" data-v-7e27a434>项目</span><!--]--></a></div><div class="pager" data-v-7e27a434><a class="VPLink link pager-link next" href="/mq5_programming_for_traders/advanced_language_tools/opencl" data-v-7e27a434><!--[--><span class="desc" data-v-7e27a434>下一页</span><span class="title" data-v-7e27a434>opencl</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-e8cbffd7 data-v-6afcd22d><div class="container" data-v-6afcd22d><!----><p class="copyright" data-v-6afcd22d>Copyright © 2025-present </p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about_index.md\":\"DgTl_xnF\",\"article_agile_dev.md\":\"NdNksZ5T\",\"article_common_custom.md\":\"Bnou3GXK\",\"article_eastore.md\":\"CgBIgP7m\",\"article_equity_control.md\":\"CLNMDT65\",\"article_index.md\":\"Wa4OTFCi\",\"article_insample_outsample.md\":\"D1MBTOel\",\"article_judge_strategy.md\":\"Cov4ctIn\",\"article_kaufman.md\":\"DOUk4OXd\",\"article_market_pending.md\":\"DsJu6rft\",\"article_market_scan.md\":\"CbZmgwd4\",\"article_monte_carlo_simulate2.md\":\"Cm4k7L6d\",\"article_mt5_ontester.md\":\"Cj6T22Pr\",\"article_overfitting_underfitting.md\":\"Cb4ZpjNj\",\"article_parameter_optimization.md\":\"BX-0xMLY\",\"article_portfolio.md\":\"D-a8WdRf\",\"article_pre_live.md\":\"D0WByXgU\",\"article_quant_rank.md\":\"CNPMm-mK\",\"article_rand_probability.md\":\"DLTTm8ny\",\"article_success_for_quant.md\":\"p_TcVXdX\",\"article_unify_price.md\":\"DzNrbUoq\",\"blog.md\":\"BBN8JdHd\",\"future_strategy_index copy.md\":\"DBE0dQPt\",\"future_strategy_index.md\":\"BHuPR8MR\",\"future_strategy_indicator_desc_chart_desc.md\":\"MO5iRmh8\",\"future_strategy_indicator_desc_index.md\":\"De3ZlhCC\",\"future_strategy_indicator_desc_indicator_desc_full.md\":\"BQF4d6Y5\",\"future_strategy_indicator_desc_model_score.md\":\"BhcfPbuw\",\"future_strategy_jump_reverse.md\":\"BHWbME5R\",\"future_strategy_macd.md\":\"BvwbMKlG\",\"index.md\":\"CQiPVH0-\",\"metaeditor_development_ai_assistant.md\":\"Qh8YIGlY\",\"metaeditor_development_c_dll.md\":\"B4yoin-H\",\"metaeditor_development_compile.md\":\"DVRo-uoD\",\"metaeditor_development_debug.md\":\"B2d4Ifvu\",\"metaeditor_development_generate_mqh.md\":\"Xd75GVMe\",\"metaeditor_development_index.md\":\"DE5MTnWI\",\"metaeditor_development_intelligent_management.md\":\"CjVjq_8j\",\"metaeditor_development_mql5_cloud_protector.md\":\"6eq8xFFz\",\"metaeditor_development_opencl.md\":\"CdDUVMDo\",\"metaeditor_development_profiling.md\":\"Dr_qEn6W\",\"metaeditor_development_python.md\":\"7f90Ke0w\",\"metaeditor_development_source_code_find.md\":\"DwXw9-7w\",\"metaeditor_development_styler.md\":\"aeVj7YCs\",\"metaeditor_main_menu_index.md\":\"CsZfAngo\",\"metaeditor_main_menu_main_menu_build.md\":\"D7tch4dN\",\"metaeditor_main_menu_main_menu_debug.md\":\"C4wAN0Bw\",\"metaeditor_main_menu_main_menu_edit.md\":\"BSEzT4HX\",\"metaeditor_main_menu_main_menu_file.md\":\"QrFMmwOF\",\"metaeditor_main_menu_main_menu_help.md\":\"C_aMJIES\",\"metaeditor_main_menu_main_menu_search.md\":\"CxQ-4Oor\",\"metaeditor_main_menu_main_menu_tools.md\":\"DQ-Dq6TH\",\"metaeditor_main_menu_main_menu_view.md\":\"DT9pbEW0\",\"metaeditor_main_menu_main_menu_window.md\":\"DCukVq7K\",\"metaeditor_mql5_wizard_index.md\":\"QlxPeAXF\",\"metaeditor_mql5_wizard_wizard_class.md\":\"BF9hu16p\",\"metaeditor_mql5_wizard_wizard_ea.md\":\"_UMZQE5z\",\"metaeditor_mql5_wizard_wizard_ea_generate.md\":\"Dlscjoyf\",\"metaeditor_mql5_wizard_wizard_include.md\":\"DgWzXxuT\",\"metaeditor_mql5_wizard_wizard_indicator.md\":\"BBJ7J478\",\"metaeditor_mql5_wizard_wizard_library.md\":\"BrDnwfZU\",\"metaeditor_mql5_wizard_wizard_script.md\":\"2lUOgcbi\",\"metaeditor_mql5storage_index.md\":\"mBzBbcmN\",\"metaeditor_mql5storage_mql5storage_connect.md\":\"iYDMainN\",\"metaeditor_mql5storage_mql5storage_diff.md\":\"5lUIXKAz\",\"metaeditor_mql5storage_mql5storage_merging.md\":\"BeryPg52\",\"metaeditor_mql5storage_mql5storage_svn_client.md\":\"FoqAuE8g\",\"metaeditor_mql5storage_mql5storage_working.md\":\"YDC3CDPd\",\"metaeditor_mql5storage_projects.md\":\"CT-WuAj-\",\"metaeditor_other_articles.md\":\"C3GAEYxI\",\"metaeditor_other_index.md\":\"DavKqh0I\",\"metaeditor_other_machine_learning.md\":\"Dvp3_p2Y\",\"metaeditor_other_mql5_help.md\":\"Dp7_k9VZ\",\"metaeditor_other_mql5community.md\":\"Qpg-vGKy\",\"metaeditor_other_project_example.md\":\"Bx-DsCI8\",\"metaeditor_other_structure.md\":\"CbGZytYU\",\"metaeditor_other_video_guides.md\":\"DL2P45uj\",\"metaeditor_toolbar_index.md\":\"eth3Ai6A\",\"metaeditor_toolbar_toolbar_customize.md\":\"CWrpOwUr\",\"metaeditor_toolbar_toolbar_search.md\":\"6scXDOKF\",\"metaeditor_toolbar_toolbar_standard.md\":\"BiyIL1uY\",\"metaeditor_welcome_index.md\":\"By1rEzqW\",\"metaeditor_welcome_integration_ide.md\":\"BUY3d7Bq\",\"metaeditor_welcome_open.md\":\"Ck35TjWz\",\"metaeditor_welcome_settings.md\":\"BAxr8soh\",\"metaeditor_workspace_hotkeys.md\":\"Czdmqi5F\",\"metaeditor_workspace_index.md\":\"CmBJn6ZH\",\"metaeditor_workspace_navigator.md\":\"DJCLqPk6\",\"metaeditor_workspace_source_code_windows.md\":\"tnuTZsRk\",\"metaeditor_workspace_status_bar.md\":\"C13k-6hq\",\"metaeditor_workspace_toolbox.md\":\"CNRIQj54\",\"mq5_programming_for_traders_advanced_language_tools_conclusion.md\":\"0PwNZPNl\",\"mq5_programming_for_traders_advanced_language_tools_connection_of_binary_format_libraries.md\":\"hvpRSgQ9\",\"mq5_programming_for_traders_advanced_language_tools_cryptography.md\":\"BTyMSjhf\",\"mq5_programming_for_traders_advanced_language_tools_custom_symbol.md\":\"CLr1ZIzp\",\"mq5_programming_for_traders_advanced_language_tools_economic_calendar.md\":\"B-1BdDqs\",\"mq5_programming_for_traders_advanced_language_tools_index.md\":\"rtzvW4xP\",\"mq5_programming_for_traders_advanced_language_tools_native_python_support.md\":\"CAzzlsno\",\"mq5_programming_for_traders_advanced_language_tools_network_functions.md\":\"DGqpCXaq\",\"mq5_programming_for_traders_advanced_language_tools_opencl.md\":\"d-FLxv9t\",\"mq5_programming_for_traders_advanced_language_tools_projects.md\":\"CwYCSmY8\",\"mq5_programming_for_traders_advanced_language_tools_resources.md\":\"DdxIf_Gq\",\"mq5_programming_for_traders_advanced_language_tools_sqlite_database.md\":\"BJJ4vRXZ\",\"mq5_programming_for_traders_common_mql5_apis_built-in_type_conversions.md\":\"BJ8b8E40\",\"mq5_programming_for_traders_common_mql5_apis_client_terminal_global_variables.md\":\"CZJKm3Tr\",\"mq5_programming_for_traders_common_mql5_apis_functions_for_working_with_time.md\":\"DI4Huh6u\",\"mq5_programming_for_traders_common_mql5_apis_index.md\":\"Bxnf4t60\",\"mq5_programming_for_traders_common_mql5_apis_mathematical_functions.md\":\"v0RcZ8Bm\",\"mq5_programming_for_traders_common_mql5_apis_matrices_and_vectors.md\":\"BloYrgu5\",\"mq5_programming_for_traders_common_mql5_apis_mql_program_execution_environment.md\":\"BYy0lKsO\",\"mq5_programming_for_traders_common_mql5_apis_user_interaction.md\":\"brOfJ4xk\",\"mq5_programming_for_traders_common_mql5_apis_working_with_arrays.md\":\"4boikkon\",\"mq5_programming_for_traders_common_mql5_apis_working_with_files.md\":\"bYurQNDG\",\"mq5_programming_for_traders_common_mql5_apis_working_with_strings_and_symbols.md\":\"BHt6IaQ5\",\"mq5_programming_for_traders_creating_application_programs_creating_custom_indicators.md\":\"Cd6PXBEr\",\"mq5_programming_for_traders_creating_application_programs_general_principles.md\":\"CecaAjsK\",\"mq5_programming_for_traders_creating_application_programs_graphical_objects.md\":\"CeRDg33Q\",\"mq5_programming_for_traders_creating_application_programs_index.md\":\"DzjN0t2z\",\"mq5_programming_for_traders_creating_application_programs_interactive_events_on_charts.md\":\"DoWfUhJ-\",\"mq5_programming_for_traders_creating_application_programs_ready-made-indicators.md\":\"CdGrAok6\",\"mq5_programming_for_traders_creating_application_programs_script_and_services.md\":\"Ds6GQ7Mu\",\"mq5_programming_for_traders_creating_application_programs_timeseries.md\":\"DAOQf8DS\",\"mq5_programming_for_traders_creating_application_programs_working_with_charts.md\":\"C8ALaJ3W\",\"mq5_programming_for_traders_creating_application_programs_working_with_timer.md\":\"rKnhTcwB\",\"mq5_programming_for_traders_mql5_programming_fundamentals_arrays.md\":\"B7TDIA2N\",\"mq5_programming_for_traders_mql5_programming_fundamentals_built-in_data_types.md\":\"BJecBoo0\",\"mq5_programming_for_traders_mql5_programming_fundamentals_expresssions.md\":\"B2GKuwhl\",\"mq5_programming_for_traders_mql5_programming_fundamentals_function.md\":\"C4vnB2H3\",\"mq5_programming_for_traders_mql5_programming_fundamentals_identifiers.md\":\"BSg_2nhU\",\"mq5_programming_for_traders_mql5_programming_fundamentals_index.md\":\"DQ0B6ZTn\",\"mq5_programming_for_traders_mql5_programming_fundamentals_preprocessor.md\":\"B_k42HAk\",\"mq5_programming_for_traders_mql5_programming_fundamentals_statements.md\":\"CWk98WNh\",\"mq5_programming_for_traders_mql5_programming_fundamentals_type_conversion.md\":\"8_ZNUVGX\",\"mq5_programming_for_traders_mql5_programming_fundamentals_variables.md\":\"C7GVmurH\",\"mq5_programming_for_traders_object_oriented_programming_classes_and_interfaces.md\":\"CzU8_4ZT\",\"mq5_programming_for_traders_object_oriented_programming_common_mql5_apis.md\":\"D5XEbYZb\",\"mq5_programming_for_traders_object_oriented_programming_index.md\":\"BBkB91cc\",\"mq5_programming_for_traders_object_oriented_programming_structures_and_unions.md\":\"Dws_3Wfi\",\"mq5_programming_for_traders_object_oriented_programming_templates.md\":\"Bp5Vsu7i\",\"mq5_programming_for_traders_trading_automation_createing_expert_advisors.md\":\"B8KWDu4f\",\"mq5_programming_for_traders_trading_automation_depth_of_market.md\":\"CJua2CZk\",\"mq5_programming_for_traders_trading_automation_financial_instruments_and_market_watch.md\":\"B9RlHY5U\",\"mq5_programming_for_traders_trading_automation_index.md\":\"DcVCA3Xb\",\"mq5_programming_for_traders_trading_automation_testing_and_optimization_of_expert_advisors.md\":\"LG4RxcmA\",\"mq5_programming_for_traders_trading_automation_trading_account_information.md\":\"CHmQrrmp\",\"mq5_programming_for_traders_welcome_assignment_and_initialization.md\":\"CdLaVmgo\",\"mq5_programming_for_traders_welcome_data_input.md\":\"B5W5WYJv\",\"mq5_programming_for_traders_welcome_data_output.md\":\"DcGmnzpC\",\"mq5_programming_for_traders_welcome_data_types_and_values.md\":\"Dv6hAERD\",\"mq5_programming_for_traders_welcome_editing_compiling_running.md\":\"BA3EGcZg\",\"mq5_programming_for_traders_welcome_error_fixing_and_debugging.md\":\"BN8lpIjA\",\"mq5_programming_for_traders_welcome_first_program.md\":\"oXez6HUu\",\"mq5_programming_for_traders_welcome_formatting.md\":\"D5ebtoBn\",\"mq5_programming_for_traders_welcome_index.md\":\"BrRXkeMt\",\"mq5_programming_for_traders_welcome_introduction_to_mql5.md\":\"BvM3hfTq\",\"mq5_programming_for_traders_welcome_mini_summary.md\":\"BSHljDGF\",\"mq5_programming_for_traders_welcome_mql5_programming_fundamentals.md\":\"BsoDEGck\",\"mq5_programming_for_traders_welcome_mql_wizard.md\":\"CwvlpJdf\",\"mq5_programming_for_traders_welcome_statements.md\":\"KkeQ-Bou\",\"mq5_programming_for_traders_welcome_variables_and_identifiers.md\":\"C9lxFFVr\",\"mt5_ctp_quick_start_account_info.md\":\"DR4Rw3CY\",\"mt5_ctp_quick_start_close_position.md\":\"BRQK4G7k\",\"mt5_ctp_quick_start_index.md\":\"B2rSyaQG\",\"mt5_ctp_quick_start_open_position.md\":\"CDyGqjc7\",\"mt5_ctp_quick_start_position_info.md\":\"TvG0GaYI\",\"mt5_quick_start_advance_konwledge_avoid_overfitting.md\":\"CYXUcurC\",\"mt5_quick_start_advance_konwledge_correlation_factor.md\":\"Df2TVMr3\",\"mt5_quick_start_advance_konwledge_evaluation_function.md\":\"CnFbM0nQ\",\"mt5_quick_start_advance_konwledge_high_quality_data.md\":\"BCe0ZMc_\",\"mt5_quick_start_advance_konwledge_index.md\":\"DfrB40VA\",\"mt5_quick_start_advance_konwledge_market_scan.md\":\"D6OwrfeJ\",\"mt5_quick_start_advance_konwledge_monte_carlo_simulate.md\":\"D5Psab6X\",\"mt5_quick_start_advance_konwledge_multiple_symbol_ea.md\":\"CqeHZuaj\",\"mt5_quick_start_advance_konwledge_oop.md\":\"Ce16Qf4A\",\"mt5_quick_start_advance_konwledge_optimize.md\":\"CBp1MtPi\",\"mt5_quick_start_advance_konwledge_strategy_portfolio_manage.md\":\"jMZCKkG3\",\"mt5_quick_start_advance_konwledge_unify_price.md\":\"Cdd48RSR\",\"mt5_quick_start_advance_konwledge_wfa.md\":\"CBVZld5V\",\"mt5_quick_start_basic_grammar_control.md\":\"DXrWevAk\",\"mt5_quick_start_basic_grammar_data_type.md\":\"bvOOK_9s\",\"mt5_quick_start_basic_grammar_ea_composition.md\":\"kmz5f2uL\",\"mt5_quick_start_basic_grammar_expression.md\":\"CFp45n45\",\"mt5_quick_start_basic_grammar_function.md\":\"DCw0nVWK\",\"mt5_quick_start_basic_grammar_index.md\":\"BcwriF-p\",\"mt5_quick_start_basic_grammar_variable.md\":\"Di2Z9VyK\",\"mt5_quick_start_classic_strategy_contrarian_rsi_ma.md\":\"C4xb6yv0\",\"mt5_quick_start_classic_strategy_donchian_channel.md\":\"WdpC59Y5\",\"mt5_quick_start_classic_strategy_ichimoku.md\":\"B5gOLF-g\",\"mt5_quick_start_classic_strategy_index.md\":\"BrXjJt2I\",\"mt5_quick_start_classic_strategy_london_break.md\":\"DA9HJO7v\",\"mt5_quick_start_classic_strategy_td9_trend.md\":\"Ur-wc6Z1\",\"mt5_quick_start_classic_strategy_triple_screen.md\":\"CKsgq5e9\",\"mt5_quick_start_first_real_ea_complete_code.md\":\"D4pYUMXn\",\"mt5_quick_start_first_real_ea_index.md\":\"Cui2l2y2\",\"mt5_quick_start_first_real_ea_indicator_data.md\":\"DXNoqidi\",\"mt5_quick_start_first_real_ea_open_detail.md\":\"DPcf3iSx\",\"mt5_quick_start_first_real_ea_param_check.md\":\"CfhNaSL3\",\"mt5_quick_start_first_real_ea_risk_manage.md\":\"CI_1yN-i\",\"mt5_quick_start_indicator_tools_calendar.md\":\"Cpcfdnjn\",\"mt5_quick_start_indicator_tools_donchian_channel.md\":\"B5qUwECO\",\"mt5_quick_start_indicator_tools_full_period_indicator_monitor.md\":\"DNudUriM\",\"mt5_quick_start_indicator_tools_index.md\":\"2t6sUfkd\",\"mt5_quick_start_indicator_tools_oncaclulate.md\":\"BdFUawHd\",\"mt5_quick_start_indicator_tools_oscillator.md\":\"CrzqRQuQ\",\"mt5_quick_start_indicator_tools_price_intensive.md\":\"C2HZffks\",\"mt5_quick_start_indicator_tools_squeeze.md\":\"Bb1ikQaT\",\"mt5_quick_start_welcome_cfd_advantage.md\":\"CsSTntXp\",\"mt5_quick_start_welcome_index.md\":\"Dm1LgN2p\",\"mt5_quick_start_welcome_mt5_ide.md\":\"CzMr1ovT\",\"mt5_quick_start_welcome_mt5_indroduce.md\":\"CdtlTrSp\",\"mt5_quick_start_welcome_outline.md\":\"CNBRu7CX\",\"mt5_strategy_boll.md\":\"BBEOdP7z\",\"mt5_strategy_bolla.md\":\"DT1oPsIT\",\"mt5_strategy_contrarian_by_rsi_ma.md\":\"D4OEmCWM\",\"mt5_strategy_debug.md\":\"BAdewFIh\",\"mt5_strategy_divergent_oscillation.md\":\"CzJS0mwx\",\"mt5_strategy_eldtriplescreen.md\":\"Bdc0kGYs\",\"mt5_strategy_frequency_trading_index.md\":\"CGgGwARD\",\"mt5_strategy_ichimokutrendflow.md\":\"DgYG27lx\",\"mt5_strategy_indicator_donchianchannel.md\":\"Dkqrg_rw\",\"mt5_strategy_indicator_oncalculate.md\":\"-UaJSB1K\",\"mt5_strategy_londonbreakout.md\":\"es6k497E\",\"mt5_strategy_macd.md\":\"CRgsbbvE\",\"mt5_strategy_martingale_index.md\":\"D0qPRVxv\",\"mt5_strategy_martingale_martingale_reverse.md\":\"C3APRr9F\",\"mt5_strategy_nr4.md\":\"D5mSofLY\",\"mt5_strategy_panel_calendar.md\":\"D672her7\",\"mt5_strategy_permission_verification.md\":\"0kLvX01z\",\"mt5_strategy_price_action_index.md\":\"DG-sY23W\",\"mt5_strategy_risk_monitor.md\":\"Bsh6-W1g\",\"mt5_strategy_strategy_quant_x.md\":\"DcC5P60N\",\"mt5_strategy_td9_trend_flow_stop_order.md\":\"dxKcn8zZ\",\"mt5_strategy_trend_follow_index.md\":\"C3GcYU33\",\"mt5_strategy_trend_follow_triple_screen.md\":\"BVqx-UX8\",\"readme.md\":\"iYUHVd_-\",\"strategy_square_index.md\":\"KIzIlrYG\",\"team.md\":\"B7810Qr2\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"专业投机策略\",\"description\":\"迎接新的时代\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":false,\"themeConfig\":{\"logo\":\"/logo.svg\",\"lastUpdated\":{\"text\":\"最近更新\"},\"outline\":{\"label\":\"本页目录\",\"level\":[2,3]},\"search\":{\"provider\":\"local\",\"options\":{\"translations\":{\"button\":{\"buttonText\":\"搜索\",\"buttonAriaLabel\":\"搜索\"},\"modal\":{\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\",\"closeText\":\"关闭\"}}}}},\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"footer\":{\"copyright\":\"Copyright © 2025-present \"},\"socialLinks\":[{\"icon\":\"tiktok\",\"link\":\"https://www.douyin.com/user/MS4wLjABAAAAVb-2dWdStZkPrNrzAGkHhhquMun5zaNAUsNPN166PCA\"},{\"icon\":\"bilibili\",\"link\":\"https://space.bilibili.com/485926738\"},{\"icon\":\"wechat\",\"link\":\"https://mp.weixin.qq.com/s/ZygbW2MwCtUQfEvXqYS1vA\"}],\"nav\":[{\"text\":\"策略广场\",\"link\":\"/strategy_square/\",\"activeMatch\":\"/strategy_square/\"},{\"text\":\"外盘策略\",\"items\":[{\"text\":\"趋势跟踪\",\"link\":\"/mt5_strategy/trend_follow/\"},{\"text\":\"马丁格尔\",\"link\":\"/mt5_strategy/martingale/\"},{\"text\":\"高频交易\",\"link\":\"/mt5_strategy/frequency_trading/\"}]},{\"text\":\"期货策略\",\"link\":\"/future_strategy/\",\"activeMatch\":\"/future_strategy/\"},{\"text\":\"MT5编辑器\",\"items\":[{\"text\":\"欢迎来到算法交易\",\"link\":\"/metaeditor/welcome/\"},{\"text\":\"主菜单\",\"link\":\"/metaeditor/main_menu/\"},{\"text\":\"工具栏\",\"link\":\"/metaeditor/toolbar/\"},{\"text\":\"工作区\",\"link\":\"/metaeditor/workspace/\"},{\"text\":\"MQL5存储\",\"link\":\"/metaeditor/mql5storage/\"},{\"text\":\"MQL4/MQL5 向导\",\"link\":\"/metaeditor/mql5_wizard/\"},{\"text\":\"开发程序\",\"link\":\"/metaeditor/development/\"},{\"text\":\"其它\",\"link\":\"/metaeditor/other/\"}]},{\"text\":\"MQL5快速入门\",\"items\":[{\"text\":\"初步认识\",\"link\":\"/mt5_quick_start/welcome/\"},{\"text\":\"基础语法\",\"link\":\"/mt5_quick_start/basic_grammar/\"},{\"text\":\"第一个EA\",\"link\":\"/mt5_quick_start/first_real_ea/\"},{\"text\":\"进阶知识\",\"link\":\"/mt5_quick_start/advance_konwledge/\"},{\"text\":\"经典策略\",\"link\":\"/mt5_quick_start/classic_strategy/\"},{\"text\":\"指标工具\",\"link\":\"/mt5_quick_start/indicator_tools/\"}]},{\"text\":\"MQL5官方教程\",\"items\":[{\"text\":\"开始\",\"link\":\"/mq5_programming_for_traders/welcome/\"},{\"text\":\"MQL5编程基础\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/\"},{\"text\":\"面向对象\",\"link\":\"/mq5_programming_for_traders/object_oriented_programming/\"},{\"text\":\"常用API\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/\"},{\"text\":\"在 MQL5 中创建应用程序\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/\"},{\"text\":\"交易自动化\",\"link\":\"/mq5_programming_for_traders/trading_automation/\"},{\"text\":\"MQL5高级工具\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/\"}]},{\"text\":\"经典文章\",\"link\":\"/article/\",\"activeMatch\":\"/article/\"},{\"text\":\"关于我\",\"link\":\"/about/\",\"activeMatch\":\"/about/\"}],\"sidebar\":{\"/mt5_strategy/\":[{\"text\":\"趋势跟踪\",\"items\":[{\"text\":\"RSI + MA\",\"link\":\"/mt5_strategy/trend_follow/\"},{\"text\":\"三重滤网\",\"link\":\"/mt5_strategy/trend_follow/triple_screen\"}]},{\"text\":\"马丁格尔\",\"items\":[{\"text\":\"通用马丁\",\"link\":\"/mt5_strategy/martingale/\"},{\"text\":\"顺势反手马丁\",\"link\":\"/mt5_strategy/martingale/martingale_reverse\"}]},{\"text\":\"高频交易\",\"items\":[{\"text\":\"剥头皮\",\"link\":\"/mt5_strategy/frequency_trading/\"}]},{\"text\":\"价格行为\",\"items\":[{\"text\":\"双底双顶\",\"link\":\"/mt5_strategy/price_action/\"}]}],\"/future_strategy/\":[{\"collapsed\":true,\"text\":\"趋势跟踪\",\"items\":[{\"text\":\"布林线\",\"link\":\"/future_strategy/\"},{\"text\":\"MACD\",\"link\":\"/future_strategy/macd\"},{\"text\":\"指标说明\",\"link\":\"/future_strategy/indicator_desc\"}]},{\"collapsed\":true,\"text\":\"区间震荡\",\"items\":[{\"text\":\"跳空反转\",\"link\":\"/future_strategy/jump_reverse\"},{\"text\":\"MACD\",\"link\":\"/future_strategy/macd\"},{\"text\":\"指标说明\",\"link\":\"/future_strategy/indicator_desc\"}]},{\"text\":\"测试报告说明\",\"items\":[{\"text\":\"效果测试说明\",\"link\":\"/future_strategy/indicator_desc/chart_desc\"},{\"text\":\"常用指标项说明\",\"link\":\"/future_strategy/indicator_desc\"},{\"text\":\"全部指标项说明\",\"link\":\"/future_strategy/indicator_desc/indicator_desc_full\"},{\"text\":\"模型打分方法\",\"link\":\"/future_strategy/indicator_desc/model_score\"}]}],\"/article/\":[{\"collapsed\":true,\"text\":\"量化\",\"items\":[{\"text\":\"梁文锋2019年演讲\",\"link\":\"/article/\"},{\"text\":\"桥水基金雷·达里奥\",\"link\":\"/article/portfolio\"},{\"text\":\"量化交易的段位\",\"link\":\"/article/quant_rank\"},{\"text\":\"解决策略过度拟合\",\"link\":\"/article/insample_outsample\"},{\"text\":\"挂单和市价单区别\",\"link\":\"/article/market_pending\"},{\"text\":\"EA商店\",\"link\":\"/article/eastore\"},{\"text\":\"评估策略是否有盈利能力\",\"link\":\"/article/judge_strategy\"},{\"text\":\"通用策略和定制策略\",\"link\":\"/article/common_custom\"},{\"text\":\"量化成功的要点\",\"link\":\"/article/success_for_quant\"},{\"text\":\"使用走完的K线\",\"link\":\"/article/unify_price\"},{\"text\":\"实盘前的准备\",\"link\":\"/article/pre_live\"},{\"text\":\"佩里·考夫曼\",\"link\":\"/article/kaufman\"},{\"text\":\"自定义统计结果\",\"link\":\"/article/mt5_ontester\"},{\"text\":\"概率优势与随机幸运\",\"link\":\"/article/rand_probability\"},{\"text\":\"量化策略的敏捷开发\",\"link\":\"/article/agile_dev\"},{\"text\":\"净值曲线控制\",\"link\":\"/article/equity_control\"}]}],\"/metaeditor/\":[{\"collapsed\":true,\"text\":\"欢迎来到算法交易\",\"items\":[{\"text\":\"开始\",\"link\":\"/metaeditor/welcome/\"},{\"text\":\"启动\",\"link\":\"/metaeditor/welcome/open\"},{\"text\":\"设置\",\"link\":\"/metaeditor/welcome/settings\"},{\"text\":\"与其它开发环境整合\",\"link\":\"/metaeditor/welcome/integration_ide\"}]},{\"collapsed\":true,\"text\":\"主菜单\",\"items\":[{\"text\":\"摘要\",\"link\":\"/metaeditor/main_menu/\"},{\"text\":\"文件\",\"link\":\"/metaeditor/main_menu/main_menu_file\"},{\"text\":\"编辑\",\"link\":\"/metaeditor/main_menu/main_menu_edit\"},{\"text\":\"搜索\",\"link\":\"/metaeditor/main_menu/main_menu_search\"},{\"text\":\"视图\",\"link\":\"/metaeditor/main_menu/main_menu_view\"},{\"text\":\"调试\",\"link\":\"/metaeditor/main_menu/main_menu_debug\"},{\"text\":\"构建\",\"link\":\"/metaeditor/main_menu/main_menu_build\"},{\"text\":\"工具\",\"link\":\"/metaeditor/main_menu/main_menu_tools\"},{\"text\":\"窗口\",\"link\":\"/metaeditor/main_menu/main_menu_window\"},{\"text\":\"帮助\",\"link\":\"/metaeditor/main_menu/main_menu_help\"}]},{\"collapsed\":true,\"text\":\"工具栏\",\"items\":[{\"text\":\"摘要\",\"link\":\"/metaeditor/toolbar/\"},{\"text\":\"标准\",\"link\":\"/metaeditor/toolbar/toolbar_standard\"},{\"text\":\"搜索\",\"link\":\"/metaeditor/toolbar/toolbar_search\"},{\"text\":\"安装\",\"link\":\"/metaeditor/toolbar/toolbar_customize\"}]},{\"collapsed\":true,\"text\":\"工作区\",\"items\":[{\"text\":\"摘要\",\"link\":\"/metaeditor/workspace/\"},{\"text\":\"导航\",\"link\":\"/metaeditor/workspace/navigator\"},{\"text\":\"工具箱\",\"link\":\"/metaeditor/workspace/toolbox\"},{\"text\":\"状态栏\",\"link\":\"/metaeditor/workspace/status_bar\"},{\"text\":\"操作窗口\",\"link\":\"/metaeditor/workspace/source_code_windows\"},{\"text\":\"热键\",\"link\":\"/metaeditor/workspace/hotkeys\"}]},{\"collapsed\":true,\"text\":\"MQL5存储\",\"items\":[{\"text\":\"摘要\",\"link\":\"/metaeditor/mql5storage/\"},{\"text\":\"启用存储\",\"link\":\"/metaeditor/mql5storage/mql5storage_connect\"},{\"text\":\"创建并操作项目\",\"link\":\"/metaeditor/mql5storage/projects\"},{\"text\":\"操控存储\",\"link\":\"/metaeditor/mql5storage/mql5storage_working\"},{\"text\":\"查看项目历史\",\"link\":\"/metaeditor/mql5storage/mql5storage_diff\"},{\"text\":\"合并修改\",\"link\":\"/metaeditor/mql5storage/mql5storage_merging\"},{\"text\":\"外部 Subversion 客户端\",\"link\":\"/metaeditor/mql5storage/mql5storage_svn_client\"}]},{\"collapsed\":true,\"text\":\"MQL4/MQL5 向导\",\"items\":[{\"text\":\"摘要\",\"link\":\"/metaeditor/mql5_wizard/\"},{\"text\":\"创建 EA 模板\",\"link\":\"/metaeditor/mql5_wizard/wizard_ea\"},{\"text\":\"创建成品智能交易系统\",\"link\":\"/metaeditor/mql5_wizard/wizard_ea_generate\"},{\"text\":\"创建指标\",\"link\":\"/metaeditor/mql5_wizard/wizard_indicator\"},{\"text\":\"创建脚本\",\"link\":\"/metaeditor/mql5_wizard/wizard_script\"},{\"text\":\"创建函数库\",\"link\":\"/metaeditor/mql5_wizard/wizard_library\"},{\"text\":\"创建包含文件\",\"link\":\"/metaeditor/mql5_wizard/wizard_include\"},{\"text\":\"创建类\",\"link\":\"/metaeditor/mql5_wizard/wizard_class\"}]},{\"collapsed\":true,\"text\":\"开发程序\",\"items\":[{\"text\":\"摘要\",\"link\":\"/metaeditor/development/\"},{\"text\":\"智能管理\",\"link\":\"/metaeditor/development/intelligent_management\"},{\"text\":\"查找和替换\",\"link\":\"/metaeditor/development/source_code_find\"},{\"text\":\"格式化\",\"link\":\"/metaeditor/development/styler\"},{\"text\":\"编译\",\"link\":\"/metaeditor/development/compile\"},{\"text\":\"MQL5 云端保护: 为程序提供先进的保护\",\"link\":\"/metaeditor/development/mql5_cloud_protector\"},{\"text\":\"代码调试\",\"link\":\"/metaeditor/development/debug\"},{\"text\":\"代码分析\",\"link\":\"/metaeditor/development/profiling\"},{\"text\":\"AI Assistant编码助手\",\"link\":\"/metaeditor/development/ai_assistant\"},{\"text\":\"生成头文件\",\"link\":\"/metaeditor/development/generate_mqh\"},{\"text\":\"调用 C++ 的 DLL (与 MS Visual Studio 集成)\",\"link\":\"/metaeditor/development/c_dll\"},{\"text\":\"使用Python\",\"link\":\"/metaeditor/development/python\"},{\"text\":\"OpenCL 支持\",\"link\":\"/metaeditor/development/opencl\"}]},{\"collapsed\":true,\"text\":\"其它\",\"items\":[{\"text\":\"SQL数据库操作\",\"link\":\"/metaeditor/other/\"},{\"text\":\"使用机器学习模型\",\"link\":\"/metaeditor/other/machine_learning\"},{\"text\":\"程序开发示例\",\"link\":\"/metaeditor/other/project_example\"},{\"text\":\"MetaEditor 环境文件夹\",\"link\":\"/metaeditor/other/structure\"},{\"text\":\"MQL5 社区: 交易者的社区\",\"link\":\"/metaeditor/other/mql5community\"},{\"text\":\"内置帮助\",\"link\":\"/metaeditor/other/mql5_help\"},{\"text\":\"有关开发交易应用程序的文章\",\"link\":\"/metaeditor/other/article\"},{\"text\":\"交易平台指南视频\",\"link\":\"/metaeditor/other/video_guides\"}]}],\"/mq5_programming_for_traders/\":[{\"text\":\"开始\",\"items\":[{\"text\":\"大纲\",\"link\":\"/mq5_programming_for_traders/welcome/\"},{\"text\":\"简介\",\"link\":\"/mq5_programming_for_traders/welcome/introduction_to_mql5\"},{\"text\":\"编辑编译运行\",\"link\":\"/mq5_programming_for_traders/welcome/editing_compiling_running\"},{\"text\":\"MQL向导\",\"link\":\"/mq5_programming_for_traders/welcome/mql_wizard\"},{\"text\":\"语句代码块函数\",\"link\":\"/mq5_programming_for_traders/welcome/statements\"},{\"text\":\"第一个程序\",\"link\":\"/mq5_programming_for_traders/welcome/first_program\"},{\"text\":\"数据类型和值\",\"link\":\"/mq5_programming_for_traders/welcome/data_types_and_values\"},{\"text\":\"变量和标识符\",\"link\":\"/mq5_programming_for_traders/welcome/variables_and_identifiers\"},{\"text\":\"赋值和初始化\",\"link\":\"/mq5_programming_for_traders/welcome/assignment_and_initialization\"},{\"text\":\"数据输入\",\"link\":\"/mq5_programming_for_traders/welcome/data_input\"},{\"text\":\"修复错误和调试\",\"link\":\"/mq5_programming_for_traders/welcome/error_fixing_and_debugging\"},{\"text\":\"数据输出\",\"link\":\"/mq5_programming_for_traders/welcome/data_output\"},{\"text\":\"格式化\",\"link\":\"/mq5_programming_for_traders/welcome/formatting\"},{\"text\":\"迷你小结\",\"link\":\"/mq5_programming_for_traders/welcome/mini_summary\"}]},{\"text\":\"MQL5编程基础\",\"collapsed\":true,\"items\":[{\"text\":\"简介\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/\"},{\"text\":\"标识符\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/identifiers/\"},{\"text\":\"内置数据类型\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/built-in_data_types/\"},{\"text\":\"变量\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/variables/\"},{\"text\":\"数组\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/arrays/\"},{\"text\":\"表达式\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/expresssions/\"},{\"text\":\"类型转换\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/type_conversion/\"},{\"text\":\"语句\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/statements/\"},{\"text\":\"函数\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/function/\"},{\"text\":\"预处理\",\"link\":\"/mq5_programming_for_traders/mql5_programming_fundamentals/preprocessor/\"}]},{\"text\":\"面向对象\",\"collapsed\":true,\"items\":[{\"text\":\"简介\",\"link\":\"/mq5_programming_for_traders/object_oriented_programming/\"},{\"text\":\"结构体和联合体\",\"link\":\"/mq5_programming_for_traders/object_oriented_programming/structures_and_unions\"},{\"text\":\"类和接口\",\"link\":\"/mq5_programming_for_traders/object_oriented_programming/classes_and_interfaces\"},{\"text\":\"模板\",\"link\":\"/mq5_programming_for_traders/object_oriented_programming/templates\"}]},{\"text\":\"常用API\",\"collapsed\":true,\"items\":[{\"text\":\"简介\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/\"},{\"text\":\"内置类型转换\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/built-in_type_conversions\"},{\"text\":\"字符串和符号处理\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/working_with_strings_and_symbols\"},{\"text\":\"数组操作\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/working_with_arrays\"},{\"text\":\"数学函数\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/mathematical_functions\"},{\"text\":\"文件操作\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/working_with_files\"},{\"text\":\"客户端全局变量\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/client_terminal_global_variables\"},{\"text\":\"时间相关函数\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/functions_for_working_with_time\"},{\"text\":\"用户交互\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/user_interaction\"},{\"text\":\"MQL 程序执行环境\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/mql_program_execution_environment\"},{\"text\":\"矩阵和向量\",\"link\":\"/mq5_programming_for_traders/common_mql5_apis/matrices_and_vectors\"}]},{\"text\":\"在 MQL5 中创建应用程序\",\"collapsed\":true,\"items\":[{\"text\":\"简介\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/\"},{\"text\":\"一般原则\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/general_principles\"},{\"text\":\"脚本和服务\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/script_and_services\"},{\"text\":\"时间序列\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/timeseries\"},{\"text\":\"自定义指标\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/creating_custom_indicators\"},{\"text\":\"自带指标\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/ready-made-indicators\"},{\"text\":\"定时器的使用\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/working_with_timer\"},{\"text\":\"图表操作\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/working_with_charts\"},{\"text\":\"图表对象\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/graphical_objects\"},{\"text\":\"图表上的交互式事件\",\"link\":\"/mq5_programming_for_traders/creating_application_programs/interactive_events_on_charts\"}]},{\"text\":\"交易自动化\",\"collapsed\":true,\"items\":[{\"text\":\"简介\",\"link\":\"/mq5_programming_for_traders/trading_automation/\"},{\"text\":\"金融工具与市场报价\",\"link\":\"/mq5_programming_for_traders/trading_automation/financial_instruments_and_market_watch\"},{\"text\":\"市场深度\",\"link\":\"/mq5_programming_for_traders/trading_automation/depth_of_market\"},{\"text\":\"交易账户信息\",\"link\":\"/mq5_programming_for_traders/trading_automation/trading_account_information\"},{\"text\":\"创建智能交易顾问\",\"link\":\"/mq5_programming_for_traders/trading_automation/createing_expert_advisors\"},{\"text\":\"专家顾问的测试和优化\",\"link\":\"/mq5_programming_for_traders/trading_automation/testing_and_optimization_of_expert_advisors\"}]},{\"text\":\"MQL5高级工具\",\"collapsed\":true,\"items\":[{\"text\":\"简介\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/\"},{\"text\":\"资源\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/resources\"},{\"text\":\"自定义交易品种\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/custom_symbol\"},{\"text\":\"经济日历\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/economic_calendar\"},{\"text\":\"密码学\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/cryptography\"},{\"text\":\"网络函数\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/network_functions\"},{\"text\":\"SQLite 数据库\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/sqlite_database\"},{\"text\":\"二进制格式库的开发与连接\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/connection_of_binary_format_libraries\"},{\"text\":\"项目\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/projects\"},{\"text\":\"原生python支持\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/native_python_support\"},{\"text\":\"opencl\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/opencl\"},{\"text\":\"总结\",\"link\":\"/mq5_programming_for_traders/advanced_language_tools/conclusion\"}]}],\"/mt5_quick_start/\":[{\"text\":\"初步认识\",\"items\":[{\"text\":\"介绍\",\"link\":\"/mt5_quick_start/welcome/\"},{\"text\":\"大纲\",\"link\":\"/mt5_quick_start/welcome/outline\"},{\"text\":\"CFD优势\",\"link\":\"/mt5_quick_start/welcome/cfd_advantage\"},{\"text\":\"认识MT5\",\"link\":\"/mt5_quick_start/welcome/mt5_indroduce\"},{\"text\":\"开发环境配置\",\"link\":\"/mt5_quick_start/welcome/mt5_ide\"}]},{\"text\":\"基础语法\",\"items\":[{\"text\":\"注释 标识符 保留字\",\"link\":\"/mt5_quick_start/basic_grammar/\"},{\"text\":\"数据类型\",\"link\":\"/mt5_quick_start/basic_grammar/data_type\"},{\"text\":\"表达式\",\"link\":\"/mt5_quick_start/basic_grammar/expression\"},{\"text\":\"EA的组成\",\"link\":\"/mt5_quick_start/basic_grammar/ea_composition\"},{\"text\":\"变量\",\"link\":\"/mt5_quick_start/basic_grammar/variable\"},{\"text\":\"控制语句\",\"link\":\"/mt5_quick_start/basic_grammar/control\"},{\"text\":\"函数\",\"link\":\"/mt5_quick_start/basic_grammar/function\"}]},{\"text\":\"第一个EA\",\"items\":[{\"text\":\"标准库 外部输入\",\"link\":\"/mt5_quick_start/first_real_ea/\"},{\"text\":\"4种资金管理方式\",\"link\":\"/mt5_quick_start/first_real_ea/risk_manage\"},{\"text\":\"指标数据\",\"link\":\"/mt5_quick_start/first_real_ea/indicator_data\"},{\"text\":\"开仓细节\",\"link\":\"/mt5_quick_start/first_real_ea/open_detail\"},{\"text\":\"完整代码\",\"link\":\"/mt5_quick_start/first_real_ea/complete_code\"}]},{\"text\":\"进阶知识\",\"items\":[{\"text\":\"常见异常\",\"link\":\"/mt5_quick_start/advance_konwledge/\"},{\"text\":\"高质量历史数据\",\"link\":\"/mt5_quick_start/advance_konwledge/high_quality_data\"},{\"text\":\"统一喂价模式\",\"link\":\"/mt5_quick_start/advance_konwledge/unify_price\"},{\"text\":\"策略组合管理\",\"link\":\"/mt5_quick_start/advance_konwledge/strategy_portfolio_manage\"},{\"text\":\"面相对象\",\"link\":\"/mt5_quick_start/advance_konwledge/oop\"},{\"text\":\"多品种EA\",\"link\":\"/mt5_quick_start/advance_konwledge/multiple_symbol_ea\"},{\"text\":\"策略优化\",\"link\":\"/mt5_quick_start/advance_konwledge/optimize\"},{\"text\":\"市场扫描\",\"link\":\"/mt5_quick_start/advance_konwledge/market_scan\"},{\"text\":\"避免过度拟合\",\"link\":\"/mt5_quick_start/advance_konwledge/avoid_overfitting\"},{\"text\":\"WFA推进分析\",\"link\":\"/mt5_quick_start/advance_konwledge/wfa\"},{\"text\":\"蒙特卡洛模拟\",\"link\":\"/mt5_quick_start/advance_konwledge/monte_carlo_simulate\"},{\"text\":\"评价函数\",\"link\":\"/mt5_quick_start/advance_konwledge/evaluation_function\"}]},{\"text\":\"经典策略\",\"items\":[{\"text\":\"高噪声震荡策略\",\"link\":\"/mt5_quick_start/classic_strategy/\"},{\"text\":\"一目均衡云\",\"link\":\"/mt5_quick_start/classic_strategy/ichimoku\"},{\"text\":\"伦敦突破\",\"link\":\"/mt5_quick_start/classic_strategy/london_break\"},{\"text\":\"三重滤网\",\"link\":\"/mt5_quick_start/classic_strategy/triple_screen\"},{\"text\":\"趋势反转\",\"link\":\"/mt5_quick_start/classic_strategy/contrarian_rsi_ma\"},{\"text\":\"风险控制\",\"link\":\"/mt5_quick_start/classic_strategy/risk_monitor\"},{\"text\":\"TD序列\",\"link\":\"/mt5_quick_start/classic_strategy/td9_trend\"},{\"text\":\"唐奇安通道\",\"link\":\"/mt5_quick_start/classic_strategy/donchian_channel\"}]},{\"text\":\"指标工具\",\"items\":[{\"text\":\"风控控制\",\"link\":\"/mt5_quick_start/indicator_tools/\"},{\"text\":\"onCalculate\",\"link\":\"/mt5_quick_start/indicator_tools/oncaclulate\"},{\"text\":\"唐奇安通道指标\",\"link\":\"/mt5_quick_start/indicator_tools/donchian_channel\"},{\"text\":\"价格密度指标\",\"link\":\"/mt5_quick_start/indicator_tools/price_intensive\"},{\"text\":\"挤压指标\",\"link\":\"/mt5_quick_start/indicator_tools/squeeze\"},{\"text\":\"乖离震荡器\",\"link\":\"/mt5_quick_start/indicator_tools/oscillator\"},{\"text\":\"全周期指标监控\",\"link\":\"/mt5_quick_start/indicator_tools/full_period_indicator_monitor\"},{\"text\":\"财经日历\",\"link\":\"/mt5_quick_start/indicator_tools/calendar\"}]}],\"/mt5_ctp/\":[{\"text\":\"零基础教程\",\"items\":[{\"text\":\"初识\",\"link\":\"/mt5_ctp/quick_start/\"},{\"text\":\"账户\",\"link\":\"/mt5_ctp/quick_start/account_info\"},{\"text\":\"持仓\",\"link\":\"/mt5_ctp/quick_start/position_info\"},{\"text\":\"开仓\",\"link\":\"/mt5_ctp/quick_start/open_position\"},{\"text\":\"平仓\",\"link\":\"/mt5_ctp/quick_start/close_position\"}]},{\"text\":\"马丁格尔\",\"items\":[{\"text\":\"通用马丁\",\"link\":\"/mt5_ctp/martingale/\"}]}]}},\"locales\":{\"root\":{\"label\":\"简体中文\"}},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>