import{_ as i,c as a,ag as l,o as t}from"./chunks/framework.CCnnzLsu.js";const g=JSON.parse('{"title":"教学EA-TD9TrendFlowStopOrder-反者道之动","description":"","frontmatter":{"head":[["link",{"rel":"canonical","href":"https://vite.dev/mt5_strategy/td9_trend_flow_stop_order"}],["meta",{"property":"og:title","content":"教学EA-TD9TrendFlowStopOrder-反者道之动"}]]},"headers":[],"relativePath":"mt5_strategy/td9_trend_flow_stop_order.md","filePath":"mt5_strategy/td9_trend_flow_stop_order.md","lastUpdated":null}'),n={name:"mt5_strategy/td9_trend_flow_stop_order.md"};function h(e,s,p,k,r,d){return t(),a("div",null,s[0]||(s[0]=[l(`<h1 id="教学ea-td9trendflowstoporder-反者道之动" tabindex="-1">教学EA-TD9TrendFlowStopOrder-反者道之动 <a class="header-anchor" href="#教学ea-td9trendflowstoporder-反者道之动" aria-label="Permalink to &quot;教学EA-TD9TrendFlowStopOrder-反者道之动&quot;">​</a></h1><h2 id="一、td序列基础概念" tabindex="-1">一、TD序列基础概念 <a class="header-anchor" href="#一、td序列基础概念" aria-label="Permalink to &quot;一、TD序列基础概念&quot;">​</a></h2><p>大家好，部分小伙伴在我讲WFA时注意到我举例的策略，想了解细节，于是有了本期内容。我们今天讲解TD序列（迪克马序列），由托马斯·马克在1970年发现，其核心理念源于更早的数学研究，该序列可将特定字母集中所有长度为N的字符串穿插其中，每个字符串恰好出现一次。应用到量化交易中，TD序列成为解析市场趋势的高效工具。</p><p>传统TD序列规则：</p><ul><li><strong>买入结构</strong>：连续9根K线，且每根收盘价均低于其前第4根K线的收盘价，形成买入信号。以首个满足条件K线的最高价作为压力位（止损参考）。</li><li><strong>卖出结构</strong>：连续9根K线，且每根收盘价均高于其前第4根K线的收盘价，形成卖出信号。以首个满足条件K线的最低价作为止损参考。</li></ul><h2 id="二、策略核心-反其道而行" tabindex="-1">二、策略核心：反其道而行 <a class="header-anchor" href="#二、策略核心-反其道而行" aria-label="Permalink to &quot;二、策略核心：反其道而行&quot;">​</a></h2><h3 id="核心理念" tabindex="-1">核心理念 <a class="header-anchor" href="#核心理念" aria-label="Permalink to &quot;核心理念&quot;">​</a></h3><p>“反者道之动”——在TD序列信号基础上反向操作：</p><ul><li>当TD买入结构形成时<strong>卖出</strong>（顺下跌趋势继续做空）；</li><li>当TD卖出结构形成时<strong>买入</strong>（顺上涨趋势继续做多）。<br> 核心逻辑：买在“别人不敢买的高点”，卖在“别人不敢空的低点”。</li></ul><h2 id="三、策略细节与进场条件" tabindex="-1">三、策略细节与进场条件 <a class="header-anchor" href="#三、策略细节与进场条件" aria-label="Permalink to &quot;三、策略细节与进场条件&quot;">​</a></h2><h3 id="_1-进场条件-以多单为例-空单反向" tabindex="-1">1. 进场条件（以多单为例，空单反向） <a class="header-anchor" href="#_1-进场条件-以多单为例-空单反向" aria-label="Permalink to &quot;1. 进场条件（以多单为例，空单反向）&quot;">​</a></h3><p>满足以下3个条件时挂<strong>突破多单</strong>：</p><ol><li>无多单持仓；</li><li>无多头挂单；</li><li>连续3根K线收盘价均高于各自前3根K线的收盘价（参数可调整，示例为3根）。</li></ol><ul><li><strong>挂单位置</strong>：前一根K线的最高点作为进场价；</li><li><strong>止损价</strong>：最近10根K线的最低点（固定止损+移动止损）；</li><li><strong>止盈</strong>：无固定止盈，依赖跟踪止损。</li></ul><h3 id="_2-删单规则" tabindex="-1">2. 删单规则 <a class="header-anchor" href="#_2-删单规则" aria-label="Permalink to &quot;2. 删单规则&quot;">​</a></h3><p>出现以下情况时删除挂单：</p><ul><li>多单挂单期间，空单信号出现；</li><li>挂单后，新的TD序列形成导致进场价变化（需按最新信号重新挂单）。</li></ul><h3 id="_3-跟踪止损" tabindex="-1">3. 跟踪止损 <a class="header-anchor" href="#_3-跟踪止损" aria-label="Permalink to &quot;3. 跟踪止损&quot;">​</a></h3><p>使用最近10根K线的最低点（多单）或最高点（空单）作为移动止损，随行情推进动态调整，锁定利润。</p><h2 id="四、盘面表现与参数建议" tabindex="-1">四、盘面表现与参数建议 <a class="header-anchor" href="#四、盘面表现与参数建议" aria-label="Permalink to &quot;四、盘面表现与参数建议&quot;">​</a></h2><ul><li><strong>信号标识</strong>：蓝色点为TD买入结构（策略反向做空），红色点为TD卖出结构（策略反向做多）。</li><li><strong>参数优化</strong>： <ul><li>TD计数参数（如9根）越大，交易机会越少，可添加挂单过期时间（如超过N根K线未成交则删单）；</li><li>止损/移动止损参数（如10根）需结合品种波动性调整。</li></ul></li></ul><h2 id="五、代码实现与逻辑解析" tabindex="-1">五、代码实现与逻辑解析 <a class="header-anchor" href="#五、代码实现与逻辑解析" aria-label="Permalink to &quot;五、代码实现与逻辑解析&quot;">​</a></h2><h3 id="_1-库与参数声明" tabindex="-1">1. 库与参数声明 <a class="header-anchor" href="#_1-库与参数声明" aria-label="Permalink to &quot;1. 库与参数声明&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 加载库  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ea </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 参数（可优化）  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">params </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;timeframe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;M15&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 时间周期  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;td_setup&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 连续K线计数  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;td_compare&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 对比前N根K线  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;sl_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # 止损/移动止损参考K线数  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_2-信号判断逻辑" tabindex="-1">2. 信号判断逻辑 <a class="header-anchor" href="#_2-信号判断逻辑" aria-label="Permalink to &quot;2. 信号判断逻辑&quot;">​</a></h3><p>核心方法<code>check_signal()</code>逐根K线判断：</p><ul><li><strong>做多信号</strong>（反向操作即做空）：当前K线收盘价 &gt; 前第<code>td_compare</code>根K线收盘价，连续满足<code>td_setup</code>次；</li><li><strong>做空信号</strong>（反向操作即做多）：当前K线收盘价 &lt; 前第<code>td_compare</code>根K线收盘价，连续满足<code>td_setup</code>次。</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> check_signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    buy_signal, sell_signal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 做多信号判断（策略中反向做空）  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.td_setup):  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> close[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> close[i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.td_compare]:  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            buy_signal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 做空信号判断（策略中反向做多）  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.td_setup):  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> close[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> close[i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.td_compare]:  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            sell_signal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> buy_signal, sell_signal</span></span></code></pre></div><h3 id="_3-挂单与仓位管理" tabindex="-1">3. 挂单与仓位管理 <a class="header-anchor" href="#_3-挂单与仓位管理" aria-label="Permalink to &quot;3. 挂单与仓位管理&quot;">​</a></h3><ul><li><strong>挂突破单</strong>：多单挂前一根K线最高点，空单挂前一根K线最低点；</li><li><strong>删单逻辑</strong>：反向信号出现或进场价变化时删除旧挂单；</li><li><strong>移动止损</strong>：动态更新最近<code>sl_count</code>根K线的极值（多单取最低，空单取最高），仅当止损朝有利方向移动时更新。</li></ul><h2 id="六、总结" tabindex="-1">六、总结 <a class="header-anchor" href="#六、总结" aria-label="Permalink to &quot;六、总结&quot;">​</a></h2><p>本策略基于价格行为，反向应用TD序列信号，通过突破挂单和动态止损捕捉趋势。核心在于“逆大众思维”，参数需结合品种特性优化，建议从较小周期和计数开始测试。</p>`,32)]))}const E=i(n,[["render",h]]);export{g as __pageData,E as default};
