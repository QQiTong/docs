import{_ as l,c as t,aI as e,o as i}from"./chunks/framework.b7dag8kZ.js";const o="/images/article/insample_outsample/island.png",r="/images/article/insample_outsample/plain.png",n="/images/article/insample_outsample/insample1.png",s="/images/article/insample_outsample/insample2.png",p="/images/article/insample_outsample/outsample1.png",m="/images/article/insample_outsample/outsample2.png",u="/images/article/insample_outsample/totalsample2.png",S=JSON.parse('{"title":"In-Sample与Out-of-Sample测试：解决策略过度拟合的关键方法","description":"","frontmatter":{"head":[["link",{"rel":"canonical","href":"https://vite.dev/article/insample_outsample"}],["meta",{"property":"og:title","content":"In-Sample与Out-of-Sample测试：解决策略过度拟合的关键方法"}]]},"headers":[],"relativePath":"article/insample_outsample.md","filePath":"article/insample_outsample.md","lastUpdated":1746376832000}'),h={name:"article/insample_outsample.md"};function c(g,a,d,_,f,b){return i(),t("div",null,a[0]||(a[0]=[e('<h1 id="in-sample与out-of-sample测试-解决策略过度拟合的关键方法" tabindex="-1">In-Sample与Out-of-Sample测试：解决策略过度拟合的关键方法 <a class="header-anchor" href="#in-sample与out-of-sample测试-解决策略过度拟合的关键方法" aria-label="Permalink to &quot;In-Sample与Out-of-Sample测试：解决策略过度拟合的关键方法&quot;">​</a></h1><h2 id="一、问题背景-为何策略回测有效但实盘亏损" tabindex="-1">一、问题背景：为何策略回测有效但实盘亏损？ <a class="header-anchor" href="#一、问题背景-为何策略回测有效但实盘亏损" aria-label="Permalink to &quot;一、问题背景：为何策略回测有效但实盘亏损？&quot;">​</a></h2><p>在量化交易中，常出现以下现象：</p><ul><li>开发的策略在历史回测中表现优异（回撤小、盈利高），但上线后却持续亏损。</li><li>核心原因是<strong>过度拟合（Overfitting）</strong>：策略在参数优化时过度适配历史数据中的噪声，导致对新数据失效。</li></ul><p>传统观点认为“历史无法代表未来”，但反过来看：若策略在历史数据中都无法盈利，更难期待其在未来盈利。因此，合理的回测与优化是必要的，但需通过科学方法规避过度拟合。</p><h2 id="二、核心概念-in-sample与out-of-sample的定义" tabindex="-1">二、核心概念：In-Sample与Out-of-Sample的定义 <a class="header-anchor" href="#二、核心概念-in-sample与out-of-sample的定义" aria-label="Permalink to &quot;二、核心概念：In-Sample与Out-of-Sample的定义&quot;">​</a></h2><h3 id="_1-统计学视角" tabindex="-1">1. 统计学视角 <a class="header-anchor" href="#_1-统计学视角" aria-label="Permalink to &quot;1. 统计学视角&quot;">​</a></h3><ul><li><strong>样本内数据（In-Sample Data）</strong>：用于策略开发和参数优化的历史数据（已知数据）。</li><li><strong>样本外数据（Out-of-Sample Data）</strong>：未参与优化、用于验证策略泛化能力的“未来数据”（未知数据）。</li></ul><h3 id="_2-传统回测的缺陷" tabindex="-1">2. 传统回测的缺陷 <a class="header-anchor" href="#_2-传统回测的缺陷" aria-label="Permalink to &quot;2. 传统回测的缺陷&quot;">​</a></h3><ul><li><strong>方法</strong>：直接使用全部历史数据（如2017-2023年BTC数据）进行回测和优化。</li><li><strong>缺点</strong>： <ul><li>优化过程类似“开卷考试”，易因市场噪声选中偶然有效的参数（“幸运拟合”）。</li><li>策略仅适配特定历史模式，无法应对新市场条件。</li></ul></li></ul><h2 id="三、in-sample与out-of-sample测试的实践方法" tabindex="-1">三、In-Sample与Out-of-Sample测试的实践方法 <a class="header-anchor" href="#三、in-sample与out-of-sample测试的实践方法" aria-label="Permalink to &quot;三、In-Sample与Out-of-Sample测试的实践方法&quot;">​</a></h2><h3 id="_1-数据分割策略" tabindex="-1">1. 数据分割策略 <a class="header-anchor" href="#_1-数据分割策略" aria-label="Permalink to &quot;1. 数据分割策略&quot;">​</a></h3><ul><li><p><strong>步骤</strong>：</p><ol><li>将历史数据划分为两部分： <ul><li><strong>In-Sample（样本内）</strong>：占比70%-80%，用于策略开发、参数优化（如2017-2021年数据）。</li><li><strong>Out-of-Sample（样本外）</strong>：占比20%-30%，用于验证优化后的策略（如2022-2023年数据）。</li></ul></li><li>在样本内进行充分优化（参数调整、逻辑迭代），不担心过度拟合，因目标是暴露策略缺陷。</li><li>用样本外数据模拟实盘环境，检验策略泛化能力。</li></ol></li><li><p><strong>分割比例权衡</strong>：</p><ul><li>样本外数据越多，验证越严格（对新数据适应性要求高），但样本内数据减少可能增加开发难度。</li><li>建议初始采用7:3或8:2分割，参数越多、优化复杂度越高，需保留更多样本外数据。</li></ul></li></ul><h3 id="_2-关键注意事项" tabindex="-1">2. 关键注意事项 <a class="header-anchor" href="#_2-关键注意事项" aria-label="Permalink to &quot;2. 关键注意事项&quot;">​</a></h3><ul><li><strong>禁止“数据渗漏”</strong>： <ul><li>样本外数据必须完全未参与策略优化（包括参数调整、逻辑修改）。</li><li><strong>错误示例</strong>：<code>若样本外验证失败后，基于其结果修改策略或参数</code>，会将样本外数据变为“隐性样本内数据”，丧失验证意义。</li></ul></li><li><strong>避免“参数孤岛”</strong>： <ul><li>优化结果中，若某组参数在样本内表现优异但周围参数均亏损（形成“孤岛”），极可能是过度拟合产物。<br><img src="'+o+'" alt=""></li><li>应选择“参数高原”区域的参数（附近参数组合表现稳定），降低对特定噪声的依赖。<br><img src="'+r+'" alt=""></li></ul></li></ul><h2 id="四、mt5平台实操演示-以btc数据为例" tabindex="-1">四、MT5平台实操演示（以BTC数据为例） <a class="header-anchor" href="#四、mt5平台实操演示-以btc数据为例" aria-label="Permalink to &quot;四、MT5平台实操演示（以BTC数据为例）&quot;">​</a></h2><h3 id="_1-样本内优化-2017-2021年" tabindex="-1">1. 样本内优化（2017-2021年） <a class="header-anchor" href="#_1-样本内优化-2017-2021年" aria-label="Permalink to &quot;1. 样本内优化（2017-2021年）&quot;">​</a></h3><ul><li><p><strong>步骤</strong>：</p><ol><li>输入参数范围（如3个参数，共288种组合），选择优化目标（如“最大结余”）。</li><li>运行完整优化或快速遗传算法，筛选绩效指标（盈利因子&gt;1.5、交易笔数&gt;200笔）。</li><li>分析权益曲线，确保策略在样本内稳定盈利（非偶然拟合）。</li></ol><h4 id="参数1" tabindex="-1">参数1 <a class="header-anchor" href="#参数1" aria-label="Permalink to &quot;参数1&quot;">​</a></h4><p><img src="'+n+'" alt=""></p><h4 id="参数2" tabindex="-1">参数2 <a class="header-anchor" href="#参数2" aria-label="Permalink to &quot;参数2&quot;">​</a></h4><p><img src="'+s+'" alt=""></p></li></ul><h3 id="_2-样本外验证-2021-2023年" tabindex="-1">2. 样本外验证（2021-2023年） <a class="header-anchor" href="#_2-样本外验证-2021-2023年" aria-label="Permalink to &quot;2. 样本外验证（2021-2023年）&quot;">​</a></h3><ul><li><p><strong>步骤</strong>：</p><ol><li>固定样本内优化得到的参数，切换时间范围至样本外数据。</li><li>运行回测，对比关键指标（如盈利因子从1.74骤降至0.66，提示过度拟合）。</li><li>仅接受在样本外仍保持正向收益的策略，拒绝依赖历史噪声的“虚假有效”参数。</li></ol><h4 id="参数1-1" tabindex="-1">参数1 <a class="header-anchor" href="#参数1-1" aria-label="Permalink to &quot;参数1&quot;">​</a></h4><p><img src="'+p+'" alt=""></p><h4 id="参数2-1" tabindex="-1">参数2 <a class="header-anchor" href="#参数2-1" aria-label="Permalink to &quot;参数2&quot;">​</a></h4><p><img src="'+m+'" alt=""></p><h4 id="结论" tabindex="-1">结论 <a class="header-anchor" href="#结论" aria-label="Permalink to &quot;结论&quot;">​</a></h4><p>对比发现参数1在样本外表现糟糕，参数2在样本外表现更好，因此采用参数2，以下是参数2样本内样本外整体曲线</p><p><img src="'+u+'" alt=""></p></li></ul><h2 id="五、扩展-数据三分法-训练集、测试集、验证集" tabindex="-1">五、扩展：数据三分法（训练集、测试集、验证集） <a class="header-anchor" href="#五、扩展-数据三分法-训练集、测试集、验证集" aria-label="Permalink to &quot;五、扩展：数据三分法（训练集、测试集、验证集）&quot;">​</a></h2><ul><li><strong>三部分划分</strong>： <ol><li><strong>训练集（Training Set）</strong>：用于策略逻辑开发（占比50%-60%）。</li><li><strong>测试集（Testing Set）</strong>：验证训练集优化效果，调整参数（占比20%-30%）。</li><li><strong>验证集（Validation Set）</strong>：最终检验策略泛化能力（占比10%-20%）。</li></ol></li><li><strong>优势</strong>：更严格规避过度拟合，适合复杂策略或多参数优化场景。</li><li><strong>注意</strong>：流程复杂度增加，需平衡开发成本与策略可靠性。</li></ul><h2 id="六、总结-科学量化的核心原则" tabindex="-1">六、总结：科学量化的核心原则 <a class="header-anchor" href="#六、总结-科学量化的核心原则" aria-label="Permalink to &quot;六、总结：科学量化的核心原则&quot;">​</a></h2><ul><li><strong>In-Sample测试</strong>：是策略开发的“实验室”，允许试错与优化。</li><li><strong>Out-of-Sample测试</strong>：是策略上线的“质检关卡”，强制验证泛化能力。</li><li><strong>核心目标</strong>：通过数据分割与严格验证，筛选出真正具备统计优势（而非偶然拟合）的策略。</li></ul><p>记住：量化交易的产出比本就应偏低——若每开发一个策略都“有效”，反而是流程存在严重问题的警示。唯有通过严谨的样本内外测试，才能在历史规律与未来不确定性之间找到平衡。</p>',25)]))}const P=l(h,[["render",c]]);export{S as __pageData,P as default};
